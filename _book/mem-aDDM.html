<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 mem-aDDM | Late Night Bayes</title>
  <meta name="description" content="A collection of reports about interesting side projects." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 mem-aDDM | Late Night Bayes" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A collection of reports about interesting side projects." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 mem-aDDM | Late Night Bayes" />
  
  <meta name="twitter:description" content="A collection of reports about interesting side projects." />
  

<meta name="author" content="Brenden Eum" />


<meta name="date" content="2024-10-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dcb.html"/>
<link rel="next" href="memDDM.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Brenden Eum</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a></li>
<li class="chapter" data-level="2" data-path="dcb.html"><a href="dcb.html"><i class="fa fa-check"></i><b>2</b> Decision Classification Boundaries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="dcb.html"><a href="dcb.html#simulated-perceptual-data-1"><i class="fa fa-check"></i><b>2.1</b> Simulated, perceptual data</a></li>
<li class="chapter" data-level="2.2" data-path="dcb.html"><a href="dcb.html#perceptual-data-ddm"><i class="fa fa-check"></i><b>2.2</b> Perceptual data, DDM</a></li>
<li class="chapter" data-level="2.3" data-path="dcb.html"><a href="dcb.html#perceptual-data-slider"><i class="fa fa-check"></i><b>2.3</b> Perceptual data, slider</a></li>
<li class="chapter" data-level="2.4" data-path="dcb.html"><a href="dcb.html#value-based-data-ddm"><i class="fa fa-check"></i><b>2.4</b> Value-based data, DDM</a></li>
<li class="chapter" data-level="2.5" data-path="dcb.html"><a href="dcb.html#value-based-data-addm"><i class="fa fa-check"></i><b>2.5</b> Value-based data, aDDM</a></li>
<li class="chapter" data-level="2.6" data-path="dcb.html"><a href="dcb.html#discussion"><i class="fa fa-check"></i><b>2.6</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mem-aDDM.html"><a href="mem-aDDM.html"><i class="fa fa-check"></i><b>3</b> mem-aDDM</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mem-aDDM.html"><a href="mem-aDDM.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="mem-aDDM.html"><a href="mem-aDDM.html#warning"><i class="fa fa-check"></i><b>3.2</b> Warning</a></li>
<li class="chapter" data-level="3.3" data-path="mem-aDDM.html"><a href="mem-aDDM.html#methods"><i class="fa fa-check"></i><b>3.3</b> Methods</a></li>
<li class="chapter" data-level="3.4" data-path="mem-aDDM.html"><a href="mem-aDDM.html#how-should-drift-change"><i class="fa fa-check"></i><b>3.4</b> How should drift change?</a></li>
<li class="chapter" data-level="3.5" data-path="mem-aDDM.html"><a href="mem-aDDM.html#mem-addm"><i class="fa fa-check"></i><b>3.5</b> mem-aDDM</a></li>
<li class="chapter" data-level="3.6" data-path="mem-aDDM.html"><a href="mem-aDDM.html#addm"><i class="fa fa-check"></i><b>3.6</b> aDDM</a></li>
<li class="chapter" data-level="3.7" data-path="mem-aDDM.html"><a href="mem-aDDM.html#compare-predictions"><i class="fa fa-check"></i><b>3.7</b> Compare predictions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="memDDM.html"><a href="memDDM.html"><i class="fa fa-check"></i><b>4</b> memDDM</a>
<ul>
<li class="chapter" data-level="4.1" data-path="memDDM.html"><a href="memDDM.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="memDDM.html"><a href="memDDM.html#methods-1"><i class="fa fa-check"></i><b>4.2</b> Methods</a></li>
<li class="chapter" data-level="4.3" data-path="memDDM.html"><a href="memDDM.html#behavioral-results"><i class="fa fa-check"></i><b>4.3</b> Behavioral Results</a></li>
<li class="chapter" data-level="4.4" data-path="memDDM.html"><a href="memDDM.html#fit-with-pyddm"><i class="fa fa-check"></i><b>4.4</b> Fit with PyDDM</a></li>
<li class="chapter" data-level="4.5" data-path="memDDM.html"><a href="memDDM.html#simulations"><i class="fa fa-check"></i><b>4.5</b> Simulations</a></li>
<li class="chapter" data-level="4.6" data-path="memDDM.html"><a href="memDDM.html#compare-simulations-and-data"><i class="fa fa-check"></i><b>4.6</b> Compare simulations and data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ddm-first-order-stochastic-dominance.html"><a href="ddm-first-order-stochastic-dominance.html"><i class="fa fa-check"></i><b>5</b> DDM &amp; First-Order Stochastic Dominance</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ddm-first-order-stochastic-dominance.html"><a href="ddm-first-order-stochastic-dominance.html#the-ddm-can-explain-violations-of-first-order-stochastic-dominance"><i class="fa fa-check"></i><b>5.1</b> The DDM Can Explain Violations of First-Order Stochastic Dominance</a></li>
<li class="chapter" data-level="5.2" data-path="ddm-first-order-stochastic-dominance.html"><a href="ddm-first-order-stochastic-dominance.html#preamble"><i class="fa fa-check"></i><b>5.2</b> Preamble</a></li>
<li class="chapter" data-level="5.3" data-path="ddm-first-order-stochastic-dominance.html"><a href="ddm-first-order-stochastic-dominance.html#ddm-simulation-function"><i class="fa fa-check"></i><b>5.3</b> DDM Simulation Function</a></li>
<li class="chapter" data-level="5.4" data-path="ddm-first-order-stochastic-dominance.html"><a href="ddm-first-order-stochastic-dominance.html#lotteries"><i class="fa fa-check"></i><b>5.4</b> Lotteries</a></li>
<li class="chapter" data-level="5.5" data-path="ddm-first-order-stochastic-dominance.html"><a href="ddm-first-order-stochastic-dominance.html#single-agent-simulations"><i class="fa fa-check"></i><b>5.5</b> Single Agent Simulations</a></li>
<li class="chapter" data-level="5.6" data-path="ddm-first-order-stochastic-dominance.html"><a href="ddm-first-order-stochastic-dominance.html#multi-agent-simulations"><i class="fa fa-check"></i><b>5.6</b> Multi-Agent Simulations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Late Night Bayes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mem-aDDM" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> mem-aDDM<a href="mem-aDDM.html#mem-aDDM" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>(TL;DR) I tried to incorporate the effects of working memory (mem-) into the Attentional Drift-Diffusion-Model (aDDM) by allowing the drift rate parameter to scale with the number of previous exposures to the chosen stimulus in the session. This was an attempt to (1) improve the accuracy of response time predictions from the aDDM and (2) model shorter response times with repeated exposures. It didn’t work, but at least now I know what not to try next ¯\<em>(ツ)</em>/¯.</p>
<center>
<img src="images/mem-aDDM-rt-results.PNG" style="width:60.0%" />
</center>
<div id="introduction" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Introduction<a href="mem-aDDM.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In value-based decisions, there are different ways that familiarity with a stimulus might affect decisions over time. Adopting intuition from Signal Detection Theory, repeated exposure to a stimulus might reduce the variance of the value signal. When it comes to sequential sampling models, we can model this in two ways. The obvious approach would be to reduce the noise parameter as a function of stimulus exposure time. However, previous studies have shown that response times decrease with repeated exposure to a stimulus in an experiment (a wonderful report written by Trinity Pruitt when she was rotating through the Rangel Lab in 2021, or <span class="citation">(<a href="#ref-agranov2017">Agranov and Ortoleva 2017</a>)</span>). A reduced noise parameter can only serve to increase response times, therefore this adjustment to the model would likely fail to account for behavior. Similarly, I believe the extension of the DDM used in <span class="citation">(<a href="#ref-agranov2017">Agranov and Ortoleva 2017</a>)</span> fails to account for the effects of repeated exposure on parameters of the DDM.</p>
<center>
<img src="images/mem-aDDM-fasterRTs.PNG" style="width:30.0%" />
Source: Trinity Pruitt. Faster RTs for stimuli seen more than the median number of times a stimulus is seen in <span class="citation">(<a href="#ref-smith2018">Smith and Krajbich 2018</a>)</span> and in <span class="citation">(<a href="#ref-eum2022">Eum, Dolbier, and Rangel 2022</a>)</span>.<br />

</center>
<p>Instead, I hypothesize that familiarity with a stimulus will affect the drift rate parameter. For one, a drift rate parameter that scales with previous encounters is capable of explaining faster response times with repeated exposure. <span class="citation">(<a href="#ref-kelly2013">Kelly and O’Connell 2013</a>)</span> find that faster response times correlate with faster buildup rate of centroparietal positive potential independent of stimulus coherence, suggesting that faster response times might be explained by a larger drift rate parameter. But the main inspiration behind an encounter-scaling drift rate parameter comes from the memory and decision-making literature. <span class="citation">(<a href="#ref-shadlen2016">Shadlen and Shohamy 2016</a>)</span> argue that value signals are modulated by memory (episodic, working, etc.), specifically that value signals in sequential sampling models integrated in the LIP are modulated by activity in the hippocampus. Studies using EEG also find a neural signal that reflects sampling from memory <span class="citation">(<a href="#ref-vanede2022">van Ede and Nobre 2022</a>)</span>. If we buy the argument that sampling from memory is more difficult than sampling from a visual representation (<span class="citation">(<a href="#ref-weilbacher2021">Weilbächer et al. 2021</a>)</span> and <span class="citation">(<a href="#ref-eum2022">Eum, Dolbier, and Rangel 2022</a>)</span>), then we might suspect that recent exposure to a stimulus will reduce the difficulty of sampling information from working memory. Again, this could potentially result in a smaller noise parameter, but seeing that this fails to explain behavior, I believe it is instead explained by drift rate parameter that scales with previous encounters.</p>
<p>I also think this will make different RT predictions depending on the value difference. Since value differences integrate over time, the lack of evidence in a difficult decision compounds over time. This means that a larger drift rate parameter will reduce response times by more in difficult choices than in easy choices. This may remedy problems that the aDDM has with fitting RT distributions across value differences (see below).</p>
<center>
<img src="images/mem-aDDM-aDDM_rt_pred.PNG" style="width:30.0%" />
</center>
<p>The goals of this report:</p>
<ol style="list-style-type: decimal">
<li>Incorporate the idea that internal samples are modulated by (and sometimes even sampled from) memory into a sequential sampling model.</li>
<li>Build a variation of the aDDM that explains shorter response times with more familiar stimuli.</li>
<li>Improve the performance of the aDDM, which has previously overestimated response times when choices are difficult.</li>
</ol>
</div>
<div id="warning" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Warning<a href="mem-aDDM.html#warning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Not a great display of coding. But with one weekend for a side-project, this is what I wound up with. If the project turns into something bigger, then I’ll consider re-writing the code into something more elegant.</p>
</div>
<div id="methods" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Methods<a href="mem-aDDM.html#methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="prep-work-4" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Prep work<a href="mem-aDDM.html#prep-work-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="load-libraries" class="section level4 hasAnchor" number="3.3.1.1">
<h4><span class="header-section-number">3.3.1.1</span> Load libraries<a href="mem-aDDM.html#load-libraries" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="mem-aDDM.html#cb40-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb40-2"><a href="mem-aDDM.html#cb40-2" tabindex="-1"></a>seed <span class="ot">=</span> <span class="dv">1337</span></span>
<span id="cb40-3"><a href="mem-aDDM.html#cb40-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb40-4"><a href="mem-aDDM.html#cb40-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb40-5"><a href="mem-aDDM.html#cb40-5" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb40-6"><a href="mem-aDDM.html#cb40-6" tabindex="-1"></a><span class="fu">library</span>(runjags)</span>
<span id="cb40-7"><a href="mem-aDDM.html#cb40-7" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb40-8"><a href="mem-aDDM.html#cb40-8" tabindex="-1"></a><span class="co">#library(cmdstanr)</span></span>
<span id="cb40-9"><a href="mem-aDDM.html#cb40-9" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb40-10"><a href="mem-aDDM.html#cb40-10" tabindex="-1"></a><span class="fu">library</span>(plotrix)</span>
<span id="cb40-11"><a href="mem-aDDM.html#cb40-11" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb40-12"><a href="mem-aDDM.html#cb40-12" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb40-13"><a href="mem-aDDM.html#cb40-13" tabindex="-1"></a><span class="co">#set_cmdstan_path(&quot;D:/Program Files/R-4.0.2/library/cmdstan-2.24.1&quot;) #gotta do this everytime :\</span></span></code></pre></div>
</div>
<div id="read-in-data-and-calculations" class="section level4 hasAnchor" number="3.3.1.2">
<h4><span class="header-section-number">3.3.1.2</span> Read-in data and calculations<a href="mem-aDDM.html#read-in-data-and-calculations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>I will use data from the “two food” choice task in <span class="citation">(<a href="#ref-smith2018">Smith and Krajbich 2018</a>)</span>. The data can be downloaded here: <a href="https://osf.io/x2jhp/?view_only=2669d8f3983d4442952a52c5de5814f7" class="uri">https://osf.io/x2jhp/?view_only=2669d8f3983d4442952a52c5de5814f7</a>. I calculate a variable called “PreviousEncountersChosen”, which counts the number of previous trials in which the subject has seen the chosen item for this trial.</p>
<p>I was thinking about extending the model so that we calculate “PreviousExposure” up until the current fixation, but this would require that we use a different (and MUCH slower) toolbox to estimate the aDDM. If we fit the data by fixations, then we need should use the Tavares toolbox <span class="citation">(<a href="#ref-tavares2017">Tavares, Perona, and Rangel 2017</a>)</span>. But, that will take a long time and will not result in posterior distributions for parameter estimates. So instead, I will use the Lombardi and Hare toolbox <span class="citation">(<a href="#ref-lombardi2021">Lombardi and Hare 2021</a>)</span> and let drift rate vary trial-by-trial systematically as a function of previous encounters. This differs from the trial-by-trial variability in drift rate that draws drift from a distribution, as in <span class="citation">(<a href="#ref-lombardi2021">Lombardi and Hare 2021</a>)</span> or <span class="citation">(<a href="#ref-eum2022">Eum, Dolbier, and Rangel 2022</a>)</span>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="mem-aDDM.html#cb41-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/mem-aDDM-smithkrajbich2018.RData&quot;</span>)</span>
<span id="cb41-2"><a href="mem-aDDM.html#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="mem-aDDM.html#cb41-3" tabindex="-1"></a>twofoodeyedata <span class="ot">&lt;-</span> twofoodeyedata <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="mem-aDDM.html#cb41-4" tabindex="-1"></a>  <span class="fu">group_by</span>(SubjectNumber, Trial) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="mem-aDDM.html#cb41-5" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="co"># fixation number</span></span>
<span id="cb41-6"><a href="mem-aDDM.html#cb41-6" tabindex="-1"></a>    <span class="at">fixNum=</span><span class="fu">row_number</span>()</span>
<span id="cb41-7"><a href="mem-aDDM.html#cb41-7" tabindex="-1"></a>  ) </span>
<span id="cb41-8"><a href="mem-aDDM.html#cb41-8" tabindex="-1"></a></span>
<span id="cb41-9"><a href="mem-aDDM.html#cb41-9" tabindex="-1"></a><span class="co"># Running counts of the number of times the subjects have seen the left and right options across previous trials</span></span>
<span id="cb41-10"><a href="mem-aDDM.html#cb41-10" tabindex="-1"></a>twofoodchoicedata<span class="sc">$</span>PreviousEncounterLeft <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb41-11"><a href="mem-aDDM.html#cb41-11" tabindex="-1"></a>twofoodchoicedata<span class="sc">$</span>PreviousEncounterRight <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb41-12"><a href="mem-aDDM.html#cb41-12" tabindex="-1"></a>data <span class="ot">&lt;-</span> twofoodchoicedata[<span class="fu">order</span>(twofoodchoicedata<span class="sc">$</span>SubjectNumber, twofoodchoicedata<span class="sc">$</span>Trial),]</span>
<span id="cb41-13"><a href="mem-aDDM.html#cb41-13" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(data<span class="sc">$</span>SubjectNumber)) {</span>
<span id="cb41-14"><a href="mem-aDDM.html#cb41-14" tabindex="-1"></a>  tempdata <span class="ot">&lt;-</span> data[data<span class="sc">$</span>SubjectNumber<span class="sc">==</span>data<span class="sc">$</span>SubjectNumber[n] <span class="sc">&amp;</span> data<span class="sc">$</span>Trial<span class="sc">&lt;=</span>data<span class="sc">$</span>Trial[n],]</span>
<span id="cb41-15"><a href="mem-aDDM.html#cb41-15" tabindex="-1"></a>  prevList <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tempdata<span class="sc">$</span>FoodLeft,tempdata<span class="sc">$</span>FoodRight)</span>
<span id="cb41-16"><a href="mem-aDDM.html#cb41-16" tabindex="-1"></a>  data<span class="sc">$</span>PreviousEncounterLeft[n] <span class="ot">&lt;-</span> <span class="fu">sum</span>(prevList<span class="sc">==</span>data<span class="sc">$</span>FoodLeft[n])<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb41-17"><a href="mem-aDDM.html#cb41-17" tabindex="-1"></a>  data<span class="sc">$</span>PreviousEncounterRight[n] <span class="ot">&lt;-</span> <span class="fu">sum</span>(prevList<span class="sc">==</span>data<span class="sc">$</span>FoodRight[n])<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb41-18"><a href="mem-aDDM.html#cb41-18" tabindex="-1"></a>}</span>
<span id="cb41-19"><a href="mem-aDDM.html#cb41-19" tabindex="-1"></a>twofoodchoicedata <span class="ot">&lt;-</span> data</span>
<span id="cb41-20"><a href="mem-aDDM.html#cb41-20" tabindex="-1"></a>twofoodchoicedata<span class="sc">$</span>PreviousEncounterBoth <span class="ot">&lt;-</span> twofoodchoicedata<span class="sc">$</span>PreviousEncounterLeft<span class="sc">+</span>twofoodchoicedata<span class="sc">$</span>PreviousEncounterRight</span>
<span id="cb41-21"><a href="mem-aDDM.html#cb41-21" tabindex="-1"></a>twofoodchoicedata<span class="sc">$</span>PreviousEncounterChosen <span class="ot">&lt;-</span> </span>
<span id="cb41-22"><a href="mem-aDDM.html#cb41-22" tabindex="-1"></a>  <span class="fu">ifelse</span>(twofoodchoicedata<span class="sc">$</span>LeftRight<span class="sc">==</span><span class="dv">1</span>, twofoodchoicedata<span class="sc">$</span>PreviousEncounterLeft, twofoodchoicedata<span class="sc">$</span>PreviousEncounterRight)</span>
<span id="cb41-23"><a href="mem-aDDM.html#cb41-23" tabindex="-1"></a></span>
<span id="cb41-24"><a href="mem-aDDM.html#cb41-24" tabindex="-1"></a>food <span class="ot">&lt;-</span> <span class="fu">merge</span>(twofoodchoicedata, twofoodeyedata, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;SubjectNumber&quot;</span>, <span class="st">&quot;Trial&quot;</span>))</span>
<span id="cb41-25"><a href="mem-aDDM.html#cb41-25" tabindex="-1"></a>food <span class="ot">&lt;-</span> food[<span class="fu">order</span>(food<span class="sc">$</span>SubjectNumber, food<span class="sc">$</span>Trial, food<span class="sc">$</span>fixNum),]</span>
<span id="cb41-26"><a href="mem-aDDM.html#cb41-26" tabindex="-1"></a>food<span class="sc">$</span>valDiff <span class="ot">&lt;-</span> food<span class="sc">$</span>ValueLeft<span class="sc">-</span>food<span class="sc">$</span>ValueRight</span>
<span id="cb41-27"><a href="mem-aDDM.html#cb41-27" tabindex="-1"></a>food<span class="sc">$</span>difficulty <span class="ot">&lt;-</span> <span class="fu">abs</span>(food<span class="sc">$</span>ValueLeft<span class="sc">-</span>food<span class="sc">$</span>ValueRight)</span>
<span id="cb41-28"><a href="mem-aDDM.html#cb41-28" tabindex="-1"></a>food<span class="sc">$</span>fixID <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(food<span class="sc">$</span>ROI<span class="sc">==</span><span class="dv">1</span>, food<span class="sc">$</span>FoodLeft, food<span class="sc">$</span>FoodRight) <span class="co"># ID for currently fixated food</span></span>
<span id="cb41-29"><a href="mem-aDDM.html#cb41-29" tabindex="-1"></a>food<span class="sc">$</span>choiceID <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(food<span class="sc">$</span>LeftRight<span class="sc">==</span><span class="dv">1</span>, food<span class="sc">$</span>FoodLeft, food<span class="sc">$</span>FoodRight) <span class="co"># ID for chosen food</span></span>
<span id="cb41-30"><a href="mem-aDDM.html#cb41-30" tabindex="-1"></a></span>
<span id="cb41-31"><a href="mem-aDDM.html#cb41-31" tabindex="-1"></a>food <span class="ot">&lt;-</span> food <span class="sc">%&gt;%</span></span>
<span id="cb41-32"><a href="mem-aDDM.html#cb41-32" tabindex="-1"></a>  <span class="fu">group_by</span>(SubjectNumber, fixID) <span class="sc">%&gt;%</span></span>
<span id="cb41-33"><a href="mem-aDDM.html#cb41-33" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="co"># Get total dwell time up until this fixation</span></span>
<span id="cb41-34"><a href="mem-aDDM.html#cb41-34" tabindex="-1"></a>    <span class="at">Exposure =</span> <span class="fu">cumsum</span>(DwellLength)<span class="sc">-</span>DwellLength </span>
<span id="cb41-35"><a href="mem-aDDM.html#cb41-35" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-36"><a href="mem-aDDM.html#cb41-36" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-37"><a href="mem-aDDM.html#cb41-37" tabindex="-1"></a>  <span class="fu">group_by</span>(SubjectNumber, Trial, fixID) <span class="sc">%&gt;%</span></span>
<span id="cb41-38"><a href="mem-aDDM.html#cb41-38" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="co"># Get total dwell time up until this trial for each unique stimulus</span></span>
<span id="cb41-39"><a href="mem-aDDM.html#cb41-39" tabindex="-1"></a>    <span class="at">TrialPreviousExposure =</span> <span class="fu">min</span>(Exposure) </span>
<span id="cb41-40"><a href="mem-aDDM.html#cb41-40" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-41"><a href="mem-aDDM.html#cb41-41" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-42"><a href="mem-aDDM.html#cb41-42" tabindex="-1"></a>  <span class="fu">group_by</span>(SubjectNumber, Trial) <span class="sc">%&gt;%</span></span>
<span id="cb41-43"><a href="mem-aDDM.html#cb41-43" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="co"># Get total dwell time for both stimuli up until this trial</span></span>
<span id="cb41-44"><a href="mem-aDDM.html#cb41-44" tabindex="-1"></a>    <span class="at">PreviousExposureBoth =</span> <span class="fu">sum</span>(<span class="fu">unique</span>(TrialPreviousExposure),<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb41-45"><a href="mem-aDDM.html#cb41-45" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-46"><a href="mem-aDDM.html#cb41-46" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-47"><a href="mem-aDDM.html#cb41-47" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-48"><a href="mem-aDDM.html#cb41-48" tabindex="-1"></a>    <span class="at">fixToChoice =</span> (fixID<span class="sc">==</span>choiceID),</span>
<span id="cb41-49"><a href="mem-aDDM.html#cb41-49" tabindex="-1"></a>    <span class="at">placeholder =</span> <span class="dv">0</span></span>
<span id="cb41-50"><a href="mem-aDDM.html#cb41-50" tabindex="-1"></a>  )</span>
<span id="cb41-51"><a href="mem-aDDM.html#cb41-51" tabindex="-1"></a></span>
<span id="cb41-52"><a href="mem-aDDM.html#cb41-52" tabindex="-1"></a>food<span class="sc">$</span>placeholder <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(food<span class="sc">$</span>fixToChoice<span class="sc">==</span><span class="dv">1</span>, food<span class="sc">$</span>TrialPreviousExposure, <span class="dv">0</span>)</span>
<span id="cb41-53"><a href="mem-aDDM.html#cb41-53" tabindex="-1"></a>food <span class="ot">&lt;-</span> food <span class="sc">%&gt;%</span></span>
<span id="cb41-54"><a href="mem-aDDM.html#cb41-54" tabindex="-1"></a>  <span class="fu">group_by</span>(SubjectNumber, Trial) <span class="sc">%&gt;%</span></span>
<span id="cb41-55"><a href="mem-aDDM.html#cb41-55" tabindex="-1"></a>  <span class="fu">mutate</span>( </span>
<span id="cb41-56"><a href="mem-aDDM.html#cb41-56" tabindex="-1"></a>    <span class="at">PreviousExposureChosen =</span> <span class="fu">max</span>(placeholder), <span class="co"># Get total dwell time for chosen stimulus up until this trial</span></span>
<span id="cb41-57"><a href="mem-aDDM.html#cb41-57" tabindex="-1"></a>    <span class="at">maxFixNum =</span> <span class="fu">max</span>(fixNum) <span class="co"># use this to get middle fixation indicators later</span></span>
<span id="cb41-58"><a href="mem-aDDM.html#cb41-58" tabindex="-1"></a>  )</span>
<span id="cb41-59"><a href="mem-aDDM.html#cb41-59" tabindex="-1"></a></span>
<span id="cb41-60"><a href="mem-aDDM.html#cb41-60" tabindex="-1"></a><span class="co"># middle fixations</span></span>
<span id="cb41-61"><a href="mem-aDDM.html#cb41-61" tabindex="-1"></a>food<span class="sc">$</span>middleFix <span class="ot">&lt;-</span> (food<span class="sc">$</span>fixNum<span class="sc">&gt;</span><span class="dv">1</span> <span class="sc">&amp;</span> food<span class="sc">$</span>fixNum<span class="sc">!=</span>food<span class="sc">$</span>maxFixNum)</span></code></pre></div>
</div>
</div>
</div>
<div id="how-should-drift-change" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> How should drift change?<a href="mem-aDDM.html#how-should-drift-change" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s regress response time on value difference (L-R) and various metrics of previous exposure. If previous exposure leads to larger drift rate parameters, then we necessarily need a negative correlation between response time and previous exposure.</p>
<p>Really quickly, let’s define the data set we will use for regressions. This should be trial-by-trial data. Also, let’s change RT to ms for better parameterization. Also, let’s set the settings for the hierarchical regressions.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="mem-aDDM.html#cb42-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> food[food<span class="sc">$</span>fixNum<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb42-2"><a href="mem-aDDM.html#cb42-2" tabindex="-1"></a>data<span class="sc">$</span>RT <span class="ot">&lt;-</span> data<span class="sc">$</span>RT<span class="sc">*</span><span class="dv">1000</span> <span class="co"># convert to ms</span></span>
<span id="cb42-3"><a href="mem-aDDM.html#cb42-3" tabindex="-1"></a></span>
<span id="cb42-4"><a href="mem-aDDM.html#cb42-4" tabindex="-1"></a>chainscores <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb42-5"><a href="mem-aDDM.html#cb42-5" tabindex="-1"></a>iterations <span class="ot">=</span> <span class="dv">6000</span></span>
<span id="cb42-6"><a href="mem-aDDM.html#cb42-6" tabindex="-1"></a>burnin <span class="ot">=</span> <span class="fu">floor</span>(iterations<span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<div id="previous-exposure-to-both-options" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Previous exposure to both options<a href="mem-aDDM.html#previous-exposure-to-both-options" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, I take previous exposure as the sum of total fixation time to either option in previous trials.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="mem-aDDM.html#cb43-1" tabindex="-1"></a><span class="co">#reg.exp.both &lt;- brm(</span></span>
<span id="cb43-2"><a href="mem-aDDM.html#cb43-2" tabindex="-1"></a><span class="co">#  RT ~ difficulty+PreviousExposureBoth + (1+difficulty+PreviousExposureBoth|SubjectNumber),</span></span>
<span id="cb43-3"><a href="mem-aDDM.html#cb43-3" tabindex="-1"></a><span class="co">#  data=data,</span></span>
<span id="cb43-4"><a href="mem-aDDM.html#cb43-4" tabindex="-1"></a><span class="co">#  family=gaussian,</span></span>
<span id="cb43-5"><a href="mem-aDDM.html#cb43-5" tabindex="-1"></a><span class="co">#  chains=chainscores,</span></span>
<span id="cb43-6"><a href="mem-aDDM.html#cb43-6" tabindex="-1"></a><span class="co">#  cores=chainscores,</span></span>
<span id="cb43-7"><a href="mem-aDDM.html#cb43-7" tabindex="-1"></a><span class="co">#  iter=iterations,</span></span>
<span id="cb43-8"><a href="mem-aDDM.html#cb43-8" tabindex="-1"></a><span class="co">#  warmup=burnin,</span></span>
<span id="cb43-9"><a href="mem-aDDM.html#cb43-9" tabindex="-1"></a><span class="co">#  seed=seed,</span></span>
<span id="cb43-10"><a href="mem-aDDM.html#cb43-10" tabindex="-1"></a><span class="co">#  refresh=0</span></span>
<span id="cb43-11"><a href="mem-aDDM.html#cb43-11" tabindex="-1"></a><span class="co">#)</span></span>
<span id="cb43-12"><a href="mem-aDDM.html#cb43-12" tabindex="-1"></a>reg.exp.both <span class="ot">=</span> <span class="fu">lm</span>(RT <span class="sc">~</span> difficulty<span class="sc">+</span>PreviousExposureBoth <span class="sc">+</span> (<span class="dv">1</span><span class="sc">+</span>difficulty<span class="sc">+</span>PreviousExposureBoth<span class="sc">|</span>SubjectNumber), <span class="at">data=</span>data)</span>
<span id="cb43-13"><a href="mem-aDDM.html#cb43-13" tabindex="-1"></a>reg.exp.both</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RT ~ difficulty + PreviousExposureBoth + (1 + difficulty + 
##     PreviousExposureBoth | SubjectNumber), data = data)
## 
## Coefficients:
##                                               (Intercept)  
##                                                   1521.98  
##                                                difficulty  
##                                                    -66.48  
##                                      PreviousExposureBoth  
##                                                    109.17  
## 1 + difficulty + PreviousExposureBoth | SubjectNumberTRUE  
##                                                        NA</code></pre>
<p>The results don’t look very promising. It doesn’t seem like previous exposure to both options is affecting the response times.</p>
</div>
<div id="previous-exposure-to-chosen-option" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Previous exposure to chosen option<a href="mem-aDDM.html#previous-exposure-to-chosen-option" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, I take previous exposure as the total fixation time to the chosen option in previous trials.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="mem-aDDM.html#cb45-1" tabindex="-1"></a><span class="co">#reg.exp.chosen &lt;- brm(</span></span>
<span id="cb45-2"><a href="mem-aDDM.html#cb45-2" tabindex="-1"></a><span class="co">#  RT ~ difficulty+PreviousExposureChosen + (1+difficulty+PreviousExposureChosen|SubjectNumber),</span></span>
<span id="cb45-3"><a href="mem-aDDM.html#cb45-3" tabindex="-1"></a><span class="co">#  data=data,</span></span>
<span id="cb45-4"><a href="mem-aDDM.html#cb45-4" tabindex="-1"></a><span class="co">#  family=gaussian,</span></span>
<span id="cb45-5"><a href="mem-aDDM.html#cb45-5" tabindex="-1"></a><span class="co">#  chains=chainscores,</span></span>
<span id="cb45-6"><a href="mem-aDDM.html#cb45-6" tabindex="-1"></a><span class="co">#  cores=chainscores,</span></span>
<span id="cb45-7"><a href="mem-aDDM.html#cb45-7" tabindex="-1"></a><span class="co">#  iter=iterations,</span></span>
<span id="cb45-8"><a href="mem-aDDM.html#cb45-8" tabindex="-1"></a><span class="co">#  warmup=burnin,</span></span>
<span id="cb45-9"><a href="mem-aDDM.html#cb45-9" tabindex="-1"></a><span class="co">#  seed=seed,</span></span>
<span id="cb45-10"><a href="mem-aDDM.html#cb45-10" tabindex="-1"></a><span class="co">#  refresh=0</span></span>
<span id="cb45-11"><a href="mem-aDDM.html#cb45-11" tabindex="-1"></a><span class="co">#)</span></span>
<span id="cb45-12"><a href="mem-aDDM.html#cb45-12" tabindex="-1"></a>reg.exp.chosen <span class="ot">=</span> <span class="fu">lm</span>(RT <span class="sc">~</span> difficulty<span class="sc">+</span>PreviousExposureChosen <span class="sc">+</span> (<span class="dv">1</span><span class="sc">+</span>difficulty<span class="sc">+</span>PreviousExposureChosen<span class="sc">|</span>SubjectNumber), <span class="at">data=</span>data)</span>
<span id="cb45-13"><a href="mem-aDDM.html#cb45-13" tabindex="-1"></a>reg.exp.chosen</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RT ~ difficulty + PreviousExposureChosen + (1 + 
##     difficulty + PreviousExposureChosen | SubjectNumber), data = data)
## 
## Coefficients:
##                                                 (Intercept)  
##                                                     1571.36  
##                                                  difficulty  
##                                                      -67.62  
##                                      PreviousExposureChosen  
##                                                      159.42  
## 1 + difficulty + PreviousExposureChosen | SubjectNumberTRUE  
##                                                          NA</code></pre>
<p>The results don’t look very promising. It doesn’t seem like previous exposure to the chosen option is affecting the response times.</p>
</div>
<div id="previous-encounters-with-both-options" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Previous encounters with both options<a href="mem-aDDM.html#previous-encounters-with-both-options" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, I take previous encounters as the number of times the subject has encountered both options before.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="mem-aDDM.html#cb47-1" tabindex="-1"></a><span class="co">#reg.enc.both &lt;- brm(</span></span>
<span id="cb47-2"><a href="mem-aDDM.html#cb47-2" tabindex="-1"></a><span class="co">#  RT ~ difficulty+PreviousEncounterBoth + (1+difficulty+PreviousEncounterBoth|SubjectNumber),</span></span>
<span id="cb47-3"><a href="mem-aDDM.html#cb47-3" tabindex="-1"></a><span class="co">#  data=data,</span></span>
<span id="cb47-4"><a href="mem-aDDM.html#cb47-4" tabindex="-1"></a><span class="co">#  family=gaussian,</span></span>
<span id="cb47-5"><a href="mem-aDDM.html#cb47-5" tabindex="-1"></a><span class="co">#  chains=chainscores,</span></span>
<span id="cb47-6"><a href="mem-aDDM.html#cb47-6" tabindex="-1"></a><span class="co">#  cores=chainscores,</span></span>
<span id="cb47-7"><a href="mem-aDDM.html#cb47-7" tabindex="-1"></a><span class="co">#  iter=iterations,</span></span>
<span id="cb47-8"><a href="mem-aDDM.html#cb47-8" tabindex="-1"></a><span class="co">#  warmup=burnin,</span></span>
<span id="cb47-9"><a href="mem-aDDM.html#cb47-9" tabindex="-1"></a><span class="co">#  seed=seed,</span></span>
<span id="cb47-10"><a href="mem-aDDM.html#cb47-10" tabindex="-1"></a><span class="co">#  save_pars = save_pars(all = TRUE), #for LOO CV later</span></span>
<span id="cb47-11"><a href="mem-aDDM.html#cb47-11" tabindex="-1"></a><span class="co">#  refresh=0</span></span>
<span id="cb47-12"><a href="mem-aDDM.html#cb47-12" tabindex="-1"></a><span class="co">#)</span></span>
<span id="cb47-13"><a href="mem-aDDM.html#cb47-13" tabindex="-1"></a>reg.enc.both <span class="ot">=</span> <span class="fu">lm</span>(RT <span class="sc">~</span> difficulty<span class="sc">+</span>PreviousEncounterBoth <span class="sc">+</span> (<span class="dv">1</span><span class="sc">+</span>difficulty<span class="sc">+</span>PreviousEncounterBoth<span class="sc">|</span>SubjectNumber), <span class="at">data=</span>data)</span>
<span id="cb47-14"><a href="mem-aDDM.html#cb47-14" tabindex="-1"></a>reg.enc.both</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RT ~ difficulty + PreviousEncounterBoth + (1 + difficulty + 
##     PreviousEncounterBoth | SubjectNumber), data = data)
## 
## Coefficients:
##                                                (Intercept)  
##                                                    1893.35  
##                                                 difficulty  
##                                                     -71.17  
##                                      PreviousEncounterBoth  
##                                                     -41.61  
## 1 + difficulty + PreviousEncounterBoth | SubjectNumberTRUE  
##                                                         NA</code></pre>
<p>Interestingly, previous encounters with both options is negatively correlated with response times.</p>
</div>
<div id="previous-encounters-with-chosen-option" class="section level3 hasAnchor" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> Previous encounters with chosen option<a href="mem-aDDM.html#previous-encounters-with-chosen-option" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, I take previous encounters as the number of times the subject has encountered the chosen option before.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="mem-aDDM.html#cb49-1" tabindex="-1"></a><span class="co">#reg.enc.chosen &lt;- brm(</span></span>
<span id="cb49-2"><a href="mem-aDDM.html#cb49-2" tabindex="-1"></a><span class="co">#  RT ~ difficulty+PreviousEncounterChosen + (1+difficulty+PreviousEncounterChosen|SubjectNumber),</span></span>
<span id="cb49-3"><a href="mem-aDDM.html#cb49-3" tabindex="-1"></a><span class="co">#  data=data,</span></span>
<span id="cb49-4"><a href="mem-aDDM.html#cb49-4" tabindex="-1"></a><span class="co">#  family=gaussian,</span></span>
<span id="cb49-5"><a href="mem-aDDM.html#cb49-5" tabindex="-1"></a><span class="co">#  chains=chainscores,</span></span>
<span id="cb49-6"><a href="mem-aDDM.html#cb49-6" tabindex="-1"></a><span class="co">#  cores=chainscores,</span></span>
<span id="cb49-7"><a href="mem-aDDM.html#cb49-7" tabindex="-1"></a><span class="co">#  iter=iterations,</span></span>
<span id="cb49-8"><a href="mem-aDDM.html#cb49-8" tabindex="-1"></a><span class="co">#  warmup=burnin,</span></span>
<span id="cb49-9"><a href="mem-aDDM.html#cb49-9" tabindex="-1"></a><span class="co">#  seed=seed,</span></span>
<span id="cb49-10"><a href="mem-aDDM.html#cb49-10" tabindex="-1"></a><span class="co">#  save_pars = save_pars(all = TRUE), #for LOO CV later</span></span>
<span id="cb49-11"><a href="mem-aDDM.html#cb49-11" tabindex="-1"></a><span class="co">#  refresh=0</span></span>
<span id="cb49-12"><a href="mem-aDDM.html#cb49-12" tabindex="-1"></a><span class="co">#)</span></span>
<span id="cb49-13"><a href="mem-aDDM.html#cb49-13" tabindex="-1"></a>reg.enc.chosen <span class="ot">=</span> <span class="fu">lm</span>(RT <span class="sc">~</span> difficulty<span class="sc">+</span>PreviousEncounterChosen <span class="sc">+</span> (<span class="dv">1</span><span class="sc">+</span>difficulty<span class="sc">+</span>PreviousEncounterChosen<span class="sc">|</span>SubjectNumber), <span class="at">data=</span>data)</span>
<span id="cb49-14"><a href="mem-aDDM.html#cb49-14" tabindex="-1"></a>reg.enc.chosen</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RT ~ difficulty + PreviousEncounterChosen + (1 + 
##     difficulty + PreviousEncounterChosen | SubjectNumber), data = data)
## 
## Coefficients:
##                                                  (Intercept)  
##                                                      1836.70  
##                                                   difficulty  
##                                                       -70.50  
##                                      PreviousEncounterChosen  
##                                                       -53.42  
## 1 + difficulty + PreviousEncounterChosen | SubjectNumberTRUE  
##                                                           NA</code></pre>
<p>It seems that previous encounters with the chosen option is also negatively correlated with response times.</p>
</div>
<div id="model-comparison" class="section level3 hasAnchor" number="3.4.5">
<h3><span class="header-section-number">3.4.5</span> Model comparison<a href="mem-aDDM.html#model-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So now we have two potential ways in which working memory might affect response times. (1) Previous encounters with both options, and (2) Previous encounters with the chosen item. Let’s run a quick model comparison using Leave-One-Out Cross Validation to see which explains the data better.</p>
<p>We are comparing the expected log pointwise predictive density (ELPD) of the “chosen” model compared to the “both” model. For this, we should look at the elpd_loo. The better model has the higher elpd_loo.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="mem-aDDM.html#cb51-1" tabindex="-1"></a><span class="co">#loo1 &lt;- loo(reg.enc.both)</span></span>
<span id="cb51-2"><a href="mem-aDDM.html#cb51-2" tabindex="-1"></a><span class="co">#loo2 &lt;- loo(reg.enc.chosen)</span></span>
<span id="cb51-3"><a href="mem-aDDM.html#cb51-3" tabindex="-1"></a></span>
<span id="cb51-4"><a href="mem-aDDM.html#cb51-4" tabindex="-1"></a><span class="co">#comparison &lt;- loo_compare(loo1,loo2)</span></span>
<span id="cb51-5"><a href="mem-aDDM.html#cb51-5" tabindex="-1"></a><span class="co">#print(comparison, simplify=FALSE, digits=3)</span></span></code></pre></div>
<p>[I ran these at some point in the past, but I didn’t want to have to rerun the MCMC algorithms when I reknit the book again. I’ve commented out all the analyses using Bayesian heirarchical modeling and used OLS instead. This means there’s no need to use ELPD, but I’ve left the written analyses in from a long time ago so you can see what the results were.]</p>
<p>It looks like previous encounters with the chosen option slightly outperforms previous encounters with both options.</p>
<p>The results here suggest that previous encounters with the chosen option are correlated with faster responses. My hunch is that working memory is somehow affecting behavior. My hypothesis is that repeated exposure to the chosen item is increasing the ease with which subjects can sample value signals from working memory <span class="citation">(<a href="#ref-weilbacher2021">Weilbächer et al. 2021</a>)</span>.</p>
<p>These results make sense with the previous literature. <span class="citation">(<a href="#ref-weilbacher2021">Weilbächer et al. 2021</a>)</span> showed that the amount of attention to an item did not affect whether or not subjects remembered that item. However, <span class="citation">(<a href="#ref-agranov2017">Agranov and Ortoleva 2017</a>)</span> found that repeated encounters with the same item sped up response times. Perhaps value become easier to sample from memory with more encounters, but is not modulated by the amount of exposure per encounter.</p>
<p>In the next section, I will design a variation of the aDDM where the drift rate scales with previous encounters with the chosen item.</p>
</div>
</div>
<div id="mem-addm" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> mem-aDDM<a href="mem-aDDM.html#mem-addm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="fitting-methods" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Fitting Methods<a href="mem-aDDM.html#fitting-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The general piecewise constant DDM (pcDDM) does not have fully time-dependent drift rates. Instead, it has drift rates that are constant over discrete intervals. The continuous pcDDM is written as follows:</p>
<p><span class="math inline">\(dx(t) = \mu(t) dt + \sigma dW(t)\)</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(x(t)\)</span> is evidence at time <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(\mu(t)\)</span> is the drift rate at time <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(\sigma\)</span> is the standard deviation of the Brownian motion</li>
<li><span class="math inline">\(W(t)\)</span> is standard Brownian motion</li>
</ul>
<p>Bias is <span class="math inline">\(x(0)=x_0\)</span>. Drift is <span class="math inline">\(\mu(t)=\mu_i\)</span> for <span class="math inline">\(t_i \leq t &lt; t_{i+1}\)</span>. Response time is <span class="math inline">\(\tau = \inf\{t&gt;0|x(t)\not\in(-B,B)\}\)</span>.</p>
<p>Following <span class="citation">(<a href="#ref-lombardi2021">Lombardi and Hare 2021</a>)</span>, we can rewrite drift rate when two conditions hold: (1) when it is constant in discrete time intervals, and (2) when stopping time is explicitly known. We rewrite it:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}

\mu(t) &amp;= \sum_{i=0}^{n-1} \mu_i 1_{[t_i,t_{i+1})} \\

\int_0^\tau \mu(t) dt &amp;= \int_0^\tau \sum_{i=0}^{n-1} \mu_i 1_{[t_i,t_{i+1})} dt \\

\int_0^\tau \sum_{i=0}^{n-1} |\mu_i 1_{[t_i,t_{i+1})}| dt &amp;&lt; \infty, \; \therefore \text{by Fubini&#39;s theorem,} \\

\int_0^\tau \mu(t) dt &amp;= \sum_{i=0}^{n-1} \int_0^\tau \mu_i 1_{[t_i,t_{i+1})} dt \\

&amp;= \sum_{i=0}^{n-1} \int_{t_i}^{t_{i+1}} \mu_i dt \\

&amp;= \tau \left( \sum_{i=0}^{n-1} \int_{t_i}^{t_{i+1}} \mu_i dt \right) \frac{1}{\tau} \\

\text{By Fundamental theorem of} &amp;\text{ calculus and some continuity conditions...} \\

&amp;= \int_0^\tau \frac{d}{d\tau} \left[ \tau \left( \sum_{i=0}^{n-1} \int_{t_i}^{t_{i+1}} \mu_i dt \right) \frac{1}{\tau} \right] dt \\

&amp;= \int_0^\tau \left( \frac{1}{\tau} \sum_{i=0}^{n-1} \int_{t_i}^{t_{i+1}} \mu_i dt \right) dt - \int_0^\tau \left( \frac{1}{\tau} \sum_{i=0}^{n-1} \int_{t_i}^{t_{i+1}} \mu_i dt \right) dt \\

&amp;= ??? \\

&amp;= \int_0^\tau \left( \frac{1}{\tau} \sum_{i=0}^{n-1} \int_{t_i}^{t_{i+1}} \mu_i dt \right) dt \\

\text{Let } t_0=0 \text{ and } t_n=\tau. &amp;\text{ If } n \text{ is the number of intervals, then} \\

\mu(t) &amp;= \frac{1}{\tau} \sum_{i=0}^{n-1} \int_{t_i}^{t_{i+1}} \mu_i dt \\

&amp;= \frac{1}{\tau} \sum_{i=0}^{n-1} \mu_i (t_{i+1}-t_i)

\end{aligned}
\end{equation}\]</span></p>
<p>Here, <span class="math inline">\(\mu_i\)</span> is constant across each time interval <span class="math inline">\((t_{i+1}-t_i)\)</span>. The drift rate in the aDDM can be written as:</p>
<p><span class="math inline">\(\bar{\mu} = \frac{\tau_A}{\tau} d (V_A-\theta V_B) + \frac{\tau_B}{\tau} d (\theta V_A- V_B)\)</span></p>
<p>I modify drift rate to account for previous encounters with the chosen option. Note that this remains constant across an entire trial, thus we can transform the drift rate parameter and still use the toolbox by <span class="citation">(<a href="#ref-lombardi2021">Lombardi and Hare 2021</a>)</span>:</p>
<p><span class="math inline">\(\bar{\mu} = (d+\gamma \text{PreviousEncounters}) \left[ \frac{\tau_A}{\tau} (V_A-\theta V_B) + \frac{\tau_B}{\tau} (\theta V_A- V_B) \right]\)</span></p>
<p>where <span class="math inline">\(\text{PreviousEncounters}\)</span> is the number of times the chosen item was seen in previous trials.</p>
</div>
<div id="lombardi-hare-toolbox" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Lombardi &amp; Hare Toolbox<a href="mem-aDDM.html#lombardi-hare-toolbox" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is the part of the toolbox that prepares the data. I’ve modified it to include PreviousEncounters.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="mem-aDDM.html#cb52-1" tabindex="-1"></a><span class="co"># # # Input a dataframe with: # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #</span></span>
<span id="cb52-2"><a href="mem-aDDM.html#cb52-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb52-3"><a href="mem-aDDM.html#cb52-3" tabindex="-1"></a><span class="co"># choice   -&gt; =1 if left food item chosen, =0 if right food item chosen</span></span>
<span id="cb52-4"><a href="mem-aDDM.html#cb52-4" tabindex="-1"></a><span class="co"># leftval  -&gt; value option on the left</span></span>
<span id="cb52-5"><a href="mem-aDDM.html#cb52-5" tabindex="-1"></a><span class="co"># rightval -&gt; value option on the right</span></span>
<span id="cb52-6"><a href="mem-aDDM.html#cb52-6" tabindex="-1"></a><span class="co"># rt       -&gt; reaction time in ms</span></span>
<span id="cb52-7"><a href="mem-aDDM.html#cb52-7" tabindex="-1"></a><span class="co"># fixnum   -&gt; fixation number</span></span>
<span id="cb52-8"><a href="mem-aDDM.html#cb52-8" tabindex="-1"></a><span class="co"># fixdur   -&gt; fixation duration in ms</span></span>
<span id="cb52-9"><a href="mem-aDDM.html#cb52-9" tabindex="-1"></a><span class="co"># pe       -&gt; total number of times the chosen option was seen in previous trials</span></span>
<span id="cb52-10"><a href="mem-aDDM.html#cb52-10" tabindex="-1"></a><span class="co"># roi      -&gt; region of interest of the fixation (1 if fixation to the left option, 2 to the right option)</span></span>
<span id="cb52-11"><a href="mem-aDDM.html#cb52-11" tabindex="-1"></a><span class="co"># trial    -&gt; trial number</span></span>
<span id="cb52-12"><a href="mem-aDDM.html#cb52-12" tabindex="-1"></a><span class="co"># subject  -&gt; subject number</span></span>
<span id="cb52-13"><a href="mem-aDDM.html#cb52-13" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb52-14"><a href="mem-aDDM.html#cb52-14" tabindex="-1"></a><span class="co"># # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # </span></span>
<span id="cb52-15"><a href="mem-aDDM.html#cb52-15" tabindex="-1"></a></span>
<span id="cb52-16"><a href="mem-aDDM.html#cb52-16" tabindex="-1"></a>LHToolbox <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb52-17"><a href="mem-aDDM.html#cb52-17" tabindex="-1"></a>  </span>
<span id="cb52-18"><a href="mem-aDDM.html#cb52-18" tabindex="-1"></a>  <span class="co"># subject numbers</span></span>
<span id="cb52-19"><a href="mem-aDDM.html#cb52-19" tabindex="-1"></a>  subjs<span class="ot">&lt;-</span> <span class="fu">unique</span>(data<span class="sc">$</span>subject)</span>
<span id="cb52-20"><a href="mem-aDDM.html#cb52-20" tabindex="-1"></a>  </span>
<span id="cb52-21"><a href="mem-aDDM.html#cb52-21" tabindex="-1"></a>  <span class="co"># calculate total fixation duration</span></span>
<span id="cb52-22"><a href="mem-aDDM.html#cb52-22" tabindex="-1"></a>  <span class="co"># total fixation time to the left option </span></span>
<span id="cb52-23"><a href="mem-aDDM.html#cb52-23" tabindex="-1"></a>  <span class="co"># and total fixation time to the right option</span></span>
<span id="cb52-24"><a href="mem-aDDM.html#cb52-24" tabindex="-1"></a>  <span class="cf">for</span>( s <span class="cf">in</span> subjs){</span>
<span id="cb52-25"><a href="mem-aDDM.html#cb52-25" tabindex="-1"></a>    <span class="cf">for</span> (t <span class="cf">in</span> <span class="fu">unique</span>(data<span class="sc">$</span>trial[data<span class="sc">$</span>subject<span class="sc">==</span>s])){</span>
<span id="cb52-26"><a href="mem-aDDM.html#cb52-26" tabindex="-1"></a>      <span class="co">#index for all fixations in one trial</span></span>
<span id="cb52-27"><a href="mem-aDDM.html#cb52-27" tabindex="-1"></a>      ind<span class="ot">=</span><span class="fu">which</span>(data<span class="sc">$</span>subject<span class="sc">==</span>s <span class="sc">&amp;</span> data<span class="sc">$</span>trial<span class="sc">==</span>t)</span>
<span id="cb52-28"><a href="mem-aDDM.html#cb52-28" tabindex="-1"></a>      <span class="co">#index for left fixations in the trial</span></span>
<span id="cb52-29"><a href="mem-aDDM.html#cb52-29" tabindex="-1"></a>      indl<span class="ot">=</span><span class="fu">which</span>(data<span class="sc">$</span>subject<span class="sc">==</span>s <span class="sc">&amp;</span> data<span class="sc">$</span>trial<span class="sc">==</span>t <span class="sc">&amp;</span> data<span class="sc">$</span>roi<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb52-30"><a href="mem-aDDM.html#cb52-30" tabindex="-1"></a>      <span class="co">#index for right fixations in the trial</span></span>
<span id="cb52-31"><a href="mem-aDDM.html#cb52-31" tabindex="-1"></a>      indr<span class="ot">=</span><span class="fu">which</span>(data<span class="sc">$</span>subject<span class="sc">==</span>s <span class="sc">&amp;</span> data<span class="sc">$</span>trial<span class="sc">==</span>t <span class="sc">&amp;</span> data<span class="sc">$</span>roi<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb52-32"><a href="mem-aDDM.html#cb52-32" tabindex="-1"></a>      <span class="co">#total fixation duration</span></span>
<span id="cb52-33"><a href="mem-aDDM.html#cb52-33" tabindex="-1"></a>      data<span class="sc">$</span>totfix[data<span class="sc">$</span>subject<span class="sc">==</span>s <span class="sc">&amp;</span> data<span class="sc">$</span>trial<span class="sc">==</span>t] <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>fixdur[ind])</span>
<span id="cb52-34"><a href="mem-aDDM.html#cb52-34" tabindex="-1"></a>      <span class="co">#fixation time to the left option</span></span>
<span id="cb52-35"><a href="mem-aDDM.html#cb52-35" tabindex="-1"></a>      data<span class="sc">$</span>fixleft[data<span class="sc">$</span>subject<span class="sc">==</span>s <span class="sc">&amp;</span> data<span class="sc">$</span>trial<span class="sc">==</span>t] <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>fixdur[indl])</span>
<span id="cb52-36"><a href="mem-aDDM.html#cb52-36" tabindex="-1"></a>      <span class="co">#fixation time to the right option</span></span>
<span id="cb52-37"><a href="mem-aDDM.html#cb52-37" tabindex="-1"></a>      data<span class="sc">$</span>fixright[data<span class="sc">$</span>subject<span class="sc">==</span>s <span class="sc">&amp;</span> data<span class="sc">$</span>trial<span class="sc">==</span>t] <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>fixdur[indr])</span>
<span id="cb52-38"><a href="mem-aDDM.html#cb52-38" tabindex="-1"></a>    }</span>
<span id="cb52-39"><a href="mem-aDDM.html#cb52-39" tabindex="-1"></a>  }</span>
<span id="cb52-40"><a href="mem-aDDM.html#cb52-40" tabindex="-1"></a>  </span>
<span id="cb52-41"><a href="mem-aDDM.html#cb52-41" tabindex="-1"></a>  <span class="co"># discard all the fixations, keep the first one</span></span>
<span id="cb52-42"><a href="mem-aDDM.html#cb52-42" tabindex="-1"></a>  data<span class="ot">&lt;-</span>data[data<span class="sc">$</span>fixnum<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb52-43"><a href="mem-aDDM.html#cb52-43" tabindex="-1"></a>  </span>
<span id="cb52-44"><a href="mem-aDDM.html#cb52-44" tabindex="-1"></a>  <span class="co">#non decision time = rt - total fixation time</span></span>
<span id="cb52-45"><a href="mem-aDDM.html#cb52-45" tabindex="-1"></a>  data<span class="sc">$</span>ndt <span class="ot">&lt;-</span> (data<span class="sc">$</span>rt <span class="sc">-</span> data<span class="sc">$</span>totfix) <span class="co"># in seconds</span></span>
<span id="cb52-46"><a href="mem-aDDM.html#cb52-46" tabindex="-1"></a>  data<span class="sc">$</span>ndt[data<span class="sc">$</span>ndt<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fl">0.0001</span> <span class="co"># you can decide whether to fit the ndt or give it as input to the model</span></span>
<span id="cb52-47"><a href="mem-aDDM.html#cb52-47" tabindex="-1"></a>  </span>
<span id="cb52-48"><a href="mem-aDDM.html#cb52-48" tabindex="-1"></a>  <span class="co"># NB BEFORE FITTING THE MODEL MAKE SURE YOU HAVE NO NAN or NA IN YOUR DATA</span></span>
<span id="cb52-49"><a href="mem-aDDM.html#cb52-49" tabindex="-1"></a>  </span>
<span id="cb52-50"><a href="mem-aDDM.html#cb52-50" tabindex="-1"></a>  <span class="co">#--------------------------------#--------------------------------</span></span>
<span id="cb52-51"><a href="mem-aDDM.html#cb52-51" tabindex="-1"></a>  </span>
<span id="cb52-52"><a href="mem-aDDM.html#cb52-52" tabindex="-1"></a>  <span class="co"># RT is positive if left food item choosen, negative if right food item chosen</span></span>
<span id="cb52-53"><a href="mem-aDDM.html#cb52-53" tabindex="-1"></a>  data<span class="sc">$</span>rtPN[data<span class="sc">$</span>choice<span class="sc">==</span><span class="dv">1</span>]<span class="ot">&lt;-</span> data<span class="sc">$</span>rt[data<span class="sc">$</span>choice<span class="sc">==</span><span class="dv">1</span>] <span class="co"># in seconds</span></span>
<span id="cb52-54"><a href="mem-aDDM.html#cb52-54" tabindex="-1"></a>  data<span class="sc">$</span>rtPN[data<span class="sc">$</span>choice<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span> <span class="sc">-</span>data<span class="sc">$</span>rt[data<span class="sc">$</span>choice<span class="sc">==</span><span class="dv">0</span>] <span class="co"># in seconds</span></span>
<span id="cb52-55"><a href="mem-aDDM.html#cb52-55" tabindex="-1"></a>  </span>
<span id="cb52-56"><a href="mem-aDDM.html#cb52-56" tabindex="-1"></a>  <span class="co"># Index of subjects</span></span>
<span id="cb52-57"><a href="mem-aDDM.html#cb52-57" tabindex="-1"></a>  idxP <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">ordered</span>(data<span class="sc">$</span>subject)) <span class="co">#makes a sequentially numbered subj index</span></span>
<span id="cb52-58"><a href="mem-aDDM.html#cb52-58" tabindex="-1"></a>  </span>
<span id="cb52-59"><a href="mem-aDDM.html#cb52-59" tabindex="-1"></a>  <span class="co"># rescale the value of the options</span></span>
<span id="cb52-60"><a href="mem-aDDM.html#cb52-60" tabindex="-1"></a>  v_left <span class="ot">=</span> data<span class="sc">$</span>leftval<span class="sc">/</span><span class="dv">10</span> <span class="co"># Smith &amp; Krajbich 2018 scale was from 1-10</span></span>
<span id="cb52-61"><a href="mem-aDDM.html#cb52-61" tabindex="-1"></a>  v_right <span class="ot">=</span> data<span class="sc">$</span>rightval<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb52-62"><a href="mem-aDDM.html#cb52-62" tabindex="-1"></a>  </span>
<span id="cb52-63"><a href="mem-aDDM.html#cb52-63" tabindex="-1"></a>  <span class="co"># value diff</span></span>
<span id="cb52-64"><a href="mem-aDDM.html#cb52-64" tabindex="-1"></a>  vDiff <span class="ot">=</span> <span class="fu">round</span>(v_left<span class="sc">-</span>v_right,<span class="dv">1</span>)</span>
<span id="cb52-65"><a href="mem-aDDM.html#cb52-65" tabindex="-1"></a>  </span>
<span id="cb52-66"><a href="mem-aDDM.html#cb52-66" tabindex="-1"></a>  <span class="co"># proportion of fixations to the left option (nb. fixright = 1-gazeL)</span></span>
<span id="cb52-67"><a href="mem-aDDM.html#cb52-67" tabindex="-1"></a>  gazeL <span class="ot">=</span> data<span class="sc">$</span>fixleft<span class="sc">/</span>data<span class="sc">$</span>totfix</span>
<span id="cb52-68"><a href="mem-aDDM.html#cb52-68" tabindex="-1"></a></span>
<span id="cb52-69"><a href="mem-aDDM.html#cb52-69" tabindex="-1"></a>  <span class="co"># rt to fit</span></span>
<span id="cb52-70"><a href="mem-aDDM.html#cb52-70" tabindex="-1"></a>  y <span class="ot">=</span> data<span class="sc">$</span>rtPN</span>
<span id="cb52-71"><a href="mem-aDDM.html#cb52-71" tabindex="-1"></a>  </span>
<span id="cb52-72"><a href="mem-aDDM.html#cb52-72" tabindex="-1"></a>  <span class="co"># number of trials</span></span>
<span id="cb52-73"><a href="mem-aDDM.html#cb52-73" tabindex="-1"></a>  N <span class="ot">=</span> <span class="fu">length</span>(y)</span>
<span id="cb52-74"><a href="mem-aDDM.html#cb52-74" tabindex="-1"></a>  </span>
<span id="cb52-75"><a href="mem-aDDM.html#cb52-75" tabindex="-1"></a>  <span class="co"># number of subjects</span></span>
<span id="cb52-76"><a href="mem-aDDM.html#cb52-76" tabindex="-1"></a>  ns <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(idxP))</span>
<span id="cb52-77"><a href="mem-aDDM.html#cb52-77" tabindex="-1"></a>  </span>
<span id="cb52-78"><a href="mem-aDDM.html#cb52-78" tabindex="-1"></a>  <span class="co"># non-decision time</span></span>
<span id="cb52-79"><a href="mem-aDDM.html#cb52-79" tabindex="-1"></a>  ndt <span class="ot">=</span> data<span class="sc">$</span>ndt</span>
<span id="cb52-80"><a href="mem-aDDM.html#cb52-80" tabindex="-1"></a>  </span>
<span id="cb52-81"><a href="mem-aDDM.html#cb52-81" tabindex="-1"></a>  <span class="co"># previous encounters, scaled from 0 to 1 by the maximum number of previous encounters.</span></span>
<span id="cb52-82"><a href="mem-aDDM.html#cb52-82" tabindex="-1"></a>  pe <span class="ot">=</span> data<span class="sc">$</span>pe<span class="sc">/</span><span class="fu">max</span>(data<span class="sc">$</span>pe)</span>
<span id="cb52-83"><a href="mem-aDDM.html#cb52-83" tabindex="-1"></a>  </span>
<span id="cb52-84"><a href="mem-aDDM.html#cb52-84" tabindex="-1"></a>  <span class="co">#--------------------------------------------</span></span>
<span id="cb52-85"><a href="mem-aDDM.html#cb52-85" tabindex="-1"></a>  <span class="co"># fit the model</span></span>
<span id="cb52-86"><a href="mem-aDDM.html#cb52-86" tabindex="-1"></a>  </span>
<span id="cb52-87"><a href="mem-aDDM.html#cb52-87" tabindex="-1"></a>  <span class="co"># data</span></span>
<span id="cb52-88"><a href="mem-aDDM.html#cb52-88" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb52-89"><a href="mem-aDDM.html#cb52-89" tabindex="-1"></a>    <span class="at">subject=</span>data<span class="sc">$</span>subject,</span>
<span id="cb52-90"><a href="mem-aDDM.html#cb52-90" tabindex="-1"></a>    <span class="at">trial=</span>data<span class="sc">$</span>trial,</span>
<span id="cb52-91"><a href="mem-aDDM.html#cb52-91" tabindex="-1"></a>    <span class="at">choice=</span>data<span class="sc">$</span>choice,</span>
<span id="cb52-92"><a href="mem-aDDM.html#cb52-92" tabindex="-1"></a>    <span class="at">rt=</span>data<span class="sc">$</span>rt,</span>
<span id="cb52-93"><a href="mem-aDDM.html#cb52-93" tabindex="-1"></a>    <span class="at">N=</span>N, </span>
<span id="cb52-94"><a href="mem-aDDM.html#cb52-94" tabindex="-1"></a>    <span class="at">y=</span>y, </span>
<span id="cb52-95"><a href="mem-aDDM.html#cb52-95" tabindex="-1"></a>    <span class="at">idxP=</span>idxP, </span>
<span id="cb52-96"><a href="mem-aDDM.html#cb52-96" tabindex="-1"></a>    <span class="at">v_L=</span>v_left,</span>
<span id="cb52-97"><a href="mem-aDDM.html#cb52-97" tabindex="-1"></a>    <span class="at">v_R=</span>v_right, </span>
<span id="cb52-98"><a href="mem-aDDM.html#cb52-98" tabindex="-1"></a>    <span class="at">vDiff=</span>vDiff,</span>
<span id="cb52-99"><a href="mem-aDDM.html#cb52-99" tabindex="-1"></a>    <span class="at">gazeL=</span>gazeL, </span>
<span id="cb52-100"><a href="mem-aDDM.html#cb52-100" tabindex="-1"></a>    <span class="at">ns=</span>ns, </span>
<span id="cb52-101"><a href="mem-aDDM.html#cb52-101" tabindex="-1"></a>    <span class="at">ndt=</span>ndt, </span>
<span id="cb52-102"><a href="mem-aDDM.html#cb52-102" tabindex="-1"></a>    <span class="at">pe=</span>pe</span>
<span id="cb52-103"><a href="mem-aDDM.html#cb52-103" tabindex="-1"></a>  )</span>
<span id="cb52-104"><a href="mem-aDDM.html#cb52-104" tabindex="-1"></a>  </span>
<span id="cb52-105"><a href="mem-aDDM.html#cb52-105" tabindex="-1"></a>  <span class="fu">return</span>(dat)</span>
<span id="cb52-106"><a href="mem-aDDM.html#cb52-106" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="jags-code" class="section level3 hasAnchor" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> JAGS code<a href="mem-aDDM.html#jags-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(RDV_t = RDV_{t-1} + (d+\gamma*\text{PreviousEncounters})\mu+\epsilon\)</span></p>
<p>where <span class="math inline">\(\mu=(V_L-\theta V_R)\)</span> if looking left, and <span class="math inline">\(\mu=(\theta V_L-V_R)\)</span> if looking right. <span class="math inline">\(\epsilon \sim N(0,\sigma)\)</span> is white, Gaussian noise. <span class="math inline">\(\gamma\)</span> is sensitivity to previous time spent looking at either stimuli.</p>
<p>Don’t forget that JAGS rnorm works with precision… so confusing keeping track of what Stan or JAGS use…</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="mem-aDDM.html#cb53-1" tabindex="-1"></a><span class="fu">cat</span>( <span class="st">&quot;model {</span></span>
<span id="cb53-2"><a href="mem-aDDM.html#cb53-2" tabindex="-1"></a></span>
<span id="cb53-3"><a href="mem-aDDM.html#cb53-3" tabindex="-1"></a><span class="st">    # drift rate</span></span>
<span id="cb53-4"><a href="mem-aDDM.html#cb53-4" tabindex="-1"></a><span class="st">        d_mu ~ dunif(0.00001,50)</span></span>
<span id="cb53-5"><a href="mem-aDDM.html#cb53-5" tabindex="-1"></a><span class="st">        d_pr ~ dgamma(1, 0.1)</span></span>
<span id="cb53-6"><a href="mem-aDDM.html#cb53-6" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb53-7"><a href="mem-aDDM.html#cb53-7" tabindex="-1"></a><span class="st">    # previous exposure sensitivity</span></span>
<span id="cb53-8"><a href="mem-aDDM.html#cb53-8" tabindex="-1"></a><span class="st">        g_mu ~ dunif(0.00001,50)</span></span>
<span id="cb53-9"><a href="mem-aDDM.html#cb53-9" tabindex="-1"></a><span class="st">        g_pr ~ dgamma(1, 0.1)</span></span>
<span id="cb53-10"><a href="mem-aDDM.html#cb53-10" tabindex="-1"></a></span>
<span id="cb53-11"><a href="mem-aDDM.html#cb53-11" tabindex="-1"></a><span class="st">    # noise</span></span>
<span id="cb53-12"><a href="mem-aDDM.html#cb53-12" tabindex="-1"></a><span class="st">        sig_mu ~ dunif(0.000001, 2)</span></span>
<span id="cb53-13"><a href="mem-aDDM.html#cb53-13" tabindex="-1"></a><span class="st">        sig_pr ~ dgamma(1, 0.1)</span></span>
<span id="cb53-14"><a href="mem-aDDM.html#cb53-14" tabindex="-1"></a></span>
<span id="cb53-15"><a href="mem-aDDM.html#cb53-15" tabindex="-1"></a><span class="st">    # Bias of the DDM</span></span>
<span id="cb53-16"><a href="mem-aDDM.html#cb53-16" tabindex="-1"></a><span class="st">        bias_alpha &lt;- bias_mu * bias_kappa</span></span>
<span id="cb53-17"><a href="mem-aDDM.html#cb53-17" tabindex="-1"></a><span class="st">        bias_beta &lt;- (1 - bias_mu) * bias_kappa</span></span>
<span id="cb53-18"><a href="mem-aDDM.html#cb53-18" tabindex="-1"></a><span class="st">        bias_mu ~ dbeta(2, 2)T(0.01,0.99)</span></span>
<span id="cb53-19"><a href="mem-aDDM.html#cb53-19" tabindex="-1"></a><span class="st">        bias_kappa ~ dgamma(1, 0.5)</span></span>
<span id="cb53-20"><a href="mem-aDDM.html#cb53-20" tabindex="-1"></a></span>
<span id="cb53-21"><a href="mem-aDDM.html#cb53-21" tabindex="-1"></a><span class="st">    # attentional bias</span></span>
<span id="cb53-22"><a href="mem-aDDM.html#cb53-22" tabindex="-1"></a><span class="st">        theta_mu ~ dnorm(.5,.3)T(0,1)</span></span>
<span id="cb53-23"><a href="mem-aDDM.html#cb53-23" tabindex="-1"></a><span class="st">        theta_pr ~ dgamma(1, 0.1)</span></span>
<span id="cb53-24"><a href="mem-aDDM.html#cb53-24" tabindex="-1"></a></span>
<span id="cb53-25"><a href="mem-aDDM.html#cb53-25" tabindex="-1"></a><span class="st">    for (p in 1:ns) { # subject level</span></span>
<span id="cb53-26"><a href="mem-aDDM.html#cb53-26" tabindex="-1"></a></span>
<span id="cb53-27"><a href="mem-aDDM.html#cb53-27" tabindex="-1"></a><span class="st">        d[p] ~ dnorm(d_mu, d_pr)T(0.000001,50)</span></span>
<span id="cb53-28"><a href="mem-aDDM.html#cb53-28" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb53-29"><a href="mem-aDDM.html#cb53-29" tabindex="-1"></a><span class="st">        g[p] ~ dnorm(g_mu, g_pr)T(0.000001,50)</span></span>
<span id="cb53-30"><a href="mem-aDDM.html#cb53-30" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb53-31"><a href="mem-aDDM.html#cb53-31" tabindex="-1"></a><span class="st">        sig[p] ~ dnorm(sig_mu, sig_pr)T(0.00001,2)</span></span>
<span id="cb53-32"><a href="mem-aDDM.html#cb53-32" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb53-33"><a href="mem-aDDM.html#cb53-33" tabindex="-1"></a><span class="st">        bias[p] ~ dbeta(bias_alpha, bias_beta)T(0.01,0.99)</span></span>
<span id="cb53-34"><a href="mem-aDDM.html#cb53-34" tabindex="-1"></a></span>
<span id="cb53-35"><a href="mem-aDDM.html#cb53-35" tabindex="-1"></a><span class="st">        theta[p] ~ dnorm(theta_mu, theta_pr)T(0,1)</span></span>
<span id="cb53-36"><a href="mem-aDDM.html#cb53-36" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb53-37"><a href="mem-aDDM.html#cb53-37" tabindex="-1"></a></span>
<span id="cb53-38"><a href="mem-aDDM.html#cb53-38" tabindex="-1"></a><span class="st">    for (i in 1:N) { # trial level</span></span>
<span id="cb53-39"><a href="mem-aDDM.html#cb53-39" tabindex="-1"></a></span>
<span id="cb53-40"><a href="mem-aDDM.html#cb53-40" tabindex="-1"></a><span class="st">    ## WIENER model, fixing the threshold to 2 and estimating the noise</span></span>
<span id="cb53-41"><a href="mem-aDDM.html#cb53-41" tabindex="-1"></a><span class="st">        y[i] ~ dwieners(2, tau[i], bet[i], w[i], sig[idxP[i]] ) # actual DDM distribution</span></span>
<span id="cb53-42"><a href="mem-aDDM.html#cb53-42" tabindex="-1"></a></span>
<span id="cb53-43"><a href="mem-aDDM.html#cb53-43" tabindex="-1"></a><span class="st">        # generate trial-by-trial nDT</span></span>
<span id="cb53-44"><a href="mem-aDDM.html#cb53-44" tabindex="-1"></a><span class="st">        tau[i] &lt;- ndt[i]</span></span>
<span id="cb53-45"><a href="mem-aDDM.html#cb53-45" tabindex="-1"></a></span>
<span id="cb53-46"><a href="mem-aDDM.html#cb53-46" tabindex="-1"></a><span class="st">        # generate trial-by-trial Bias</span></span>
<span id="cb53-47"><a href="mem-aDDM.html#cb53-47" tabindex="-1"></a><span class="st">        bet[i] &lt;- bias[idxP[i]]</span></span>
<span id="cb53-48"><a href="mem-aDDM.html#cb53-48" tabindex="-1"></a></span>
<span id="cb53-49"><a href="mem-aDDM.html#cb53-49" tabindex="-1"></a><span class="st">        # Drift rate</span></span>
<span id="cb53-50"><a href="mem-aDDM.html#cb53-50" tabindex="-1"></a><span class="st">        w[i] &lt;- (d[idxP[i]]+g[idxP[i]]*pe[i]) * ( (gazeL[i]*v_L[i] - (1-gazeL[i])*v_R[i]) + theta[idxP[i]]*((1-gazeL[i])*v_L[i] - gazeL[i]*v_R[i]))</span></span>
<span id="cb53-51"><a href="mem-aDDM.html#cb53-51" tabindex="-1"></a></span>
<span id="cb53-52"><a href="mem-aDDM.html#cb53-52" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb53-53"><a href="mem-aDDM.html#cb53-53" tabindex="-1"></a><span class="st">}&quot;</span>, <span class="at">file=</span><span class="st">&quot;temp/mem-aDDM_memaDDM.txt&quot;</span>)</span></code></pre></div>
</div>
<div id="fit-mem-addm" class="section level3 hasAnchor" number="3.5.4">
<h3><span class="header-section-number">3.5.4</span> Fit mem-aDDM<a href="mem-aDDM.html#fit-mem-addm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use odd trials as training data. At the end, check whether all distributions have converged with Gelman-Rubin statistics.</p>
<p><strong>One key thing I’ve learned about the Lombardi-Hare Toolbox from this project: If non-decision time takes up more than 99% of the response time, the JAGS wiener module will completely break (“Node inconsistent with parent”). To use the toolbox, you need to drop the trials where (NDT/RT) &gt; 0.99!</strong></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="mem-aDDM.html#cb54-1" tabindex="-1"></a><span class="co"># rename and transform</span></span>
<span id="cb54-2"><a href="mem-aDDM.html#cb54-2" tabindex="-1"></a>toolboxdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb54-3"><a href="mem-aDDM.html#cb54-3" tabindex="-1"></a>  <span class="at">choice =</span> <span class="fu">ifelse</span>(food<span class="sc">$</span>LeftRight<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb54-4"><a href="mem-aDDM.html#cb54-4" tabindex="-1"></a>  <span class="at">leftval =</span> food<span class="sc">$</span>ValueLeft,</span>
<span id="cb54-5"><a href="mem-aDDM.html#cb54-5" tabindex="-1"></a>  <span class="at">rightval =</span> food<span class="sc">$</span>ValueRight,</span>
<span id="cb54-6"><a href="mem-aDDM.html#cb54-6" tabindex="-1"></a>  <span class="at">rt =</span> food<span class="sc">$</span>RT,</span>
<span id="cb54-7"><a href="mem-aDDM.html#cb54-7" tabindex="-1"></a>  <span class="at">fixnum =</span> food<span class="sc">$</span>fixNum,</span>
<span id="cb54-8"><a href="mem-aDDM.html#cb54-8" tabindex="-1"></a>  <span class="at">fixdur =</span> food<span class="sc">$</span>DwellLength,</span>
<span id="cb54-9"><a href="mem-aDDM.html#cb54-9" tabindex="-1"></a>  <span class="at">pe =</span> food<span class="sc">$</span>PreviousEncounterChosen,</span>
<span id="cb54-10"><a href="mem-aDDM.html#cb54-10" tabindex="-1"></a>  <span class="at">roi =</span> <span class="fu">ifelse</span>(food<span class="sc">$</span>ROI<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb54-11"><a href="mem-aDDM.html#cb54-11" tabindex="-1"></a>  <span class="at">trial =</span> food<span class="sc">$</span>Trial,</span>
<span id="cb54-12"><a href="mem-aDDM.html#cb54-12" tabindex="-1"></a>  <span class="at">subject =</span> food<span class="sc">$</span>SubjectNumber,</span>
<span id="cb54-13"><a href="mem-aDDM.html#cb54-13" tabindex="-1"></a>  <span class="at">totfix =</span> <span class="cn">NA</span>, <span class="co">#placeholder</span></span>
<span id="cb54-14"><a href="mem-aDDM.html#cb54-14" tabindex="-1"></a>  <span class="at">fixleft =</span> <span class="cn">NA</span>, <span class="co">#placeholder</span></span>
<span id="cb54-15"><a href="mem-aDDM.html#cb54-15" tabindex="-1"></a>  <span class="at">fixright =</span> <span class="cn">NA</span> <span class="co">#placeholder</span></span>
<span id="cb54-16"><a href="mem-aDDM.html#cb54-16" tabindex="-1"></a>)</span>
<span id="cb54-17"><a href="mem-aDDM.html#cb54-17" tabindex="-1"></a>train <span class="ot">&lt;-</span> toolboxdata[toolboxdata<span class="sc">$</span>trial<span class="sc">%%</span><span class="dv">2</span><span class="sc">!=</span><span class="dv">0</span>,] <span class="co"># Training data</span></span>
<span id="cb54-18"><a href="mem-aDDM.html#cb54-18" tabindex="-1"></a>test <span class="ot">&lt;-</span> toolboxdata[toolboxdata<span class="sc">$</span>trial<span class="sc">%%</span><span class="dv">2</span><span class="sc">==</span><span class="dv">0</span>,] <span class="co"># Testing data</span></span>
<span id="cb54-19"><a href="mem-aDDM.html#cb54-19" tabindex="-1"></a></span>
<span id="cb54-20"><a href="mem-aDDM.html#cb54-20" tabindex="-1"></a><span class="co"># Lombardi Hare toolbox transformation</span></span>
<span id="cb54-21"><a href="mem-aDDM.html#cb54-21" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">LHToolbox</span>(train))</span>
<span id="cb54-22"><a href="mem-aDDM.html#cb54-22" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">LHToolbox</span>(test))</span>
<span id="cb54-23"><a href="mem-aDDM.html#cb54-23" tabindex="-1"></a></span>
<span id="cb54-24"><a href="mem-aDDM.html#cb54-24" tabindex="-1"></a><span class="co"># Drop any trials where NDT is more than 99% of the trial. Why?</span></span>
<span id="cb54-25"><a href="mem-aDDM.html#cb54-25" tabindex="-1"></a><span class="co"># (1) This breaks JAGS wiener module.</span></span>
<span id="cb54-26"><a href="mem-aDDM.html#cb54-26" tabindex="-1"></a><span class="co"># (2) Who the heck is spending more than 99% of a trial not fixating on anything?</span></span>
<span id="cb54-27"><a href="mem-aDDM.html#cb54-27" tabindex="-1"></a>train<span class="sc">$</span>who <span class="ot">&lt;-</span> train<span class="sc">$</span>ndt<span class="sc">/</span>train<span class="sc">$</span>rt</span>
<span id="cb54-28"><a href="mem-aDDM.html#cb54-28" tabindex="-1"></a>train <span class="ot">&lt;-</span> train[train<span class="sc">$</span>who<span class="sc">&lt;</span>.<span class="dv">99</span>,]</span>
<span id="cb54-29"><a href="mem-aDDM.html#cb54-29" tabindex="-1"></a>test<span class="sc">$</span>who <span class="ot">&lt;-</span> test<span class="sc">$</span>ndt<span class="sc">/</span>test<span class="sc">$</span>rt</span>
<span id="cb54-30"><a href="mem-aDDM.html#cb54-30" tabindex="-1"></a>test <span class="ot">&lt;-</span> test[test<span class="sc">$</span>who<span class="sc">&lt;</span>.<span class="dv">99</span>,]</span>
<span id="cb54-31"><a href="mem-aDDM.html#cb54-31" tabindex="-1"></a></span>
<span id="cb54-32"><a href="mem-aDDM.html#cb54-32" tabindex="-1"></a><span class="co"># Any recent adjustments to the data require that I remake the data dump that goes into JAGS</span></span>
<span id="cb54-33"><a href="mem-aDDM.html#cb54-33" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">dump.format</span>(<span class="fu">list</span>(</span>
<span id="cb54-34"><a href="mem-aDDM.html#cb54-34" tabindex="-1"></a>  <span class="at">N=</span><span class="fu">length</span>(train<span class="sc">$</span>y), </span>
<span id="cb54-35"><a href="mem-aDDM.html#cb54-35" tabindex="-1"></a>  <span class="at">y=</span>train<span class="sc">$</span>y, </span>
<span id="cb54-36"><a href="mem-aDDM.html#cb54-36" tabindex="-1"></a>  <span class="at">idxP=</span><span class="fu">as.numeric</span>(<span class="fu">ordered</span>(train<span class="sc">$</span>subject)), </span>
<span id="cb54-37"><a href="mem-aDDM.html#cb54-37" tabindex="-1"></a>  <span class="at">v_L=</span>train<span class="sc">$</span>v_L,</span>
<span id="cb54-38"><a href="mem-aDDM.html#cb54-38" tabindex="-1"></a>  <span class="at">v_R=</span>train<span class="sc">$</span>v_R, </span>
<span id="cb54-39"><a href="mem-aDDM.html#cb54-39" tabindex="-1"></a>  <span class="at">gazeL=</span>train<span class="sc">$</span>gazeL, </span>
<span id="cb54-40"><a href="mem-aDDM.html#cb54-40" tabindex="-1"></a>  <span class="at">ns=</span><span class="fu">length</span>(<span class="fu">unique</span>(train<span class="sc">$</span>subject)), </span>
<span id="cb54-41"><a href="mem-aDDM.html#cb54-41" tabindex="-1"></a>  <span class="at">ndt=</span>train<span class="sc">$</span>ndt, </span>
<span id="cb54-42"><a href="mem-aDDM.html#cb54-42" tabindex="-1"></a>  <span class="at">pe=</span>train<span class="sc">$</span>pe</span>
<span id="cb54-43"><a href="mem-aDDM.html#cb54-43" tabindex="-1"></a>))</span>
<span id="cb54-44"><a href="mem-aDDM.html#cb54-44" tabindex="-1"></a></span>
<span id="cb54-45"><a href="mem-aDDM.html#cb54-45" tabindex="-1"></a><span class="co"># initial guesses</span></span>
<span id="cb54-46"><a href="mem-aDDM.html#cb54-46" tabindex="-1"></a>inits1 <span class="ot">&lt;-</span> <span class="fu">dump.format</span>(<span class="fu">list</span>( </span>
<span id="cb54-47"><a href="mem-aDDM.html#cb54-47" tabindex="-1"></a>  <span class="at">d_mu=</span><span class="fl">0.2</span>, <span class="at">d_pr=</span><span class="fl">0.05</span>,</span>
<span id="cb54-48"><a href="mem-aDDM.html#cb54-48" tabindex="-1"></a>  <span class="at">g_mu=</span><span class="fl">0.2</span>, <span class="at">g_pr=</span><span class="fl">0.05</span>,</span>
<span id="cb54-49"><a href="mem-aDDM.html#cb54-49" tabindex="-1"></a>  <span class="at">sig_mu=</span><span class="dv">1</span>,<span class="at">sig_pr=</span><span class="dv">1</span>,</span>
<span id="cb54-50"><a href="mem-aDDM.html#cb54-50" tabindex="-1"></a>  <span class="at">bias_mu=</span><span class="fl">0.5</span>, <span class="at">bias_kappa=</span><span class="dv">1</span>,</span>
<span id="cb54-51"><a href="mem-aDDM.html#cb54-51" tabindex="-1"></a>  <span class="at">theta_mu=</span><span class="fl">0.6</span>,<span class="at">theta_pr=</span><span class="fl">0.5</span>,</span>
<span id="cb54-52"><a href="mem-aDDM.html#cb54-52" tabindex="-1"></a>  <span class="at">.RNG.name=</span><span class="st">&quot;base::Super-Duper&quot;</span>, <span class="at">.RNG.seed=</span><span class="dv">1</span></span>
<span id="cb54-53"><a href="mem-aDDM.html#cb54-53" tabindex="-1"></a>))</span>
<span id="cb54-54"><a href="mem-aDDM.html#cb54-54" tabindex="-1"></a></span>
<span id="cb54-55"><a href="mem-aDDM.html#cb54-55" tabindex="-1"></a>inits2 <span class="ot">&lt;-</span> <span class="fu">dump.format</span>(<span class="fu">list</span>( </span>
<span id="cb54-56"><a href="mem-aDDM.html#cb54-56" tabindex="-1"></a>  <span class="at">d_mu=</span><span class="fl">0.1</span>, <span class="at">d_pr=</span><span class="fl">0.05</span>,</span>
<span id="cb54-57"><a href="mem-aDDM.html#cb54-57" tabindex="-1"></a>  <span class="at">g_mu=</span><span class="fl">0.1</span>, <span class="at">g_pr=</span><span class="fl">0.05</span>,</span>
<span id="cb54-58"><a href="mem-aDDM.html#cb54-58" tabindex="-1"></a>  <span class="at">sig_mu=</span><span class="dv">1</span>,<span class="at">sig_pr=</span><span class="dv">1</span>,</span>
<span id="cb54-59"><a href="mem-aDDM.html#cb54-59" tabindex="-1"></a>  <span class="at">bias_mu=</span><span class="fl">0.6</span>, <span class="at">bias_kappa=</span><span class="dv">1</span>,</span>
<span id="cb54-60"><a href="mem-aDDM.html#cb54-60" tabindex="-1"></a>  <span class="at">theta_mu=</span><span class="fl">0.5</span>,<span class="at">theta_pr=</span><span class="fl">0.5</span>,</span>
<span id="cb54-61"><a href="mem-aDDM.html#cb54-61" tabindex="-1"></a>  <span class="at">.RNG.name=</span><span class="st">&quot;base::Wichmann-Hill&quot;</span>, <span class="at">.RNG.seed=</span><span class="dv">2</span></span>
<span id="cb54-62"><a href="mem-aDDM.html#cb54-62" tabindex="-1"></a>))</span>
<span id="cb54-63"><a href="mem-aDDM.html#cb54-63" tabindex="-1"></a></span>
<span id="cb54-64"><a href="mem-aDDM.html#cb54-64" tabindex="-1"></a>inits3 <span class="ot">&lt;-</span> <span class="fu">dump.format</span>(<span class="fu">list</span>( </span>
<span id="cb54-65"><a href="mem-aDDM.html#cb54-65" tabindex="-1"></a>  <span class="at">d_mu=</span><span class="fl">0.05</span>, <span class="at">d_pr=</span><span class="fl">0.05</span>,</span>
<span id="cb54-66"><a href="mem-aDDM.html#cb54-66" tabindex="-1"></a>  <span class="at">g_mu=</span><span class="fl">0.05</span>, <span class="at">g_pr=</span><span class="fl">0.05</span>,</span>
<span id="cb54-67"><a href="mem-aDDM.html#cb54-67" tabindex="-1"></a>  <span class="at">sig_mu=</span><span class="dv">1</span>,<span class="at">sig_pr=</span><span class="dv">1</span>,</span>
<span id="cb54-68"><a href="mem-aDDM.html#cb54-68" tabindex="-1"></a>  <span class="at">bias_mu=</span><span class="fl">0.4</span>, <span class="at">bias_kappa=</span><span class="dv">1</span>,</span>
<span id="cb54-69"><a href="mem-aDDM.html#cb54-69" tabindex="-1"></a>  <span class="at">theta_mu=</span><span class="fl">0.2</span>,<span class="at">theta_pr=</span><span class="fl">0.5</span>,</span>
<span id="cb54-70"><a href="mem-aDDM.html#cb54-70" tabindex="-1"></a>  <span class="at">.RNG.name=</span><span class="st">&quot;base::Mersenne-Twister&quot;</span>, <span class="at">.RNG.seed=</span><span class="dv">3</span></span>
<span id="cb54-71"><a href="mem-aDDM.html#cb54-71" tabindex="-1"></a>))</span>
<span id="cb54-72"><a href="mem-aDDM.html#cb54-72" tabindex="-1"></a></span>
<span id="cb54-73"><a href="mem-aDDM.html#cb54-73" tabindex="-1"></a><span class="co"># parameters to monitor</span></span>
<span id="cb54-74"><a href="mem-aDDM.html#cb54-74" tabindex="-1"></a>monitor <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb54-75"><a href="mem-aDDM.html#cb54-75" tabindex="-1"></a>  <span class="st">&quot;d_mu&quot;</span>, <span class="st">&quot;d_pr&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="co"># drift rate</span></span>
<span id="cb54-76"><a href="mem-aDDM.html#cb54-76" tabindex="-1"></a>  <span class="st">&quot;g_mu&quot;</span>, <span class="st">&quot;g_pr&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="co"># exposure modulates drift rate</span></span>
<span id="cb54-77"><a href="mem-aDDM.html#cb54-77" tabindex="-1"></a>  <span class="st">&quot;sig_mu&quot;</span>, <span class="st">&quot;sig_pr&quot;</span>, <span class="st">&quot;sig&quot;</span>, <span class="co"># noise </span></span>
<span id="cb54-78"><a href="mem-aDDM.html#cb54-78" tabindex="-1"></a>  <span class="st">&quot;bias_mu&quot;</span>, <span class="st">&quot;bias_kappa&quot;</span>, <span class="st">&quot;bias&quot;</span>, <span class="co"># bias</span></span>
<span id="cb54-79"><a href="mem-aDDM.html#cb54-79" tabindex="-1"></a>  <span class="st">&quot;theta_mu&quot;</span>, <span class="st">&quot;theta_pr&quot;</span>, <span class="st">&quot;theta&quot;</span> <span class="co"># attentional discounting</span></span>
<span id="cb54-80"><a href="mem-aDDM.html#cb54-80" tabindex="-1"></a>) </span>
<span id="cb54-81"><a href="mem-aDDM.html#cb54-81" tabindex="-1"></a></span>
<span id="cb54-82"><a href="mem-aDDM.html#cb54-82" tabindex="-1"></a><span class="co"># # run the fitting</span></span>
<span id="cb54-83"><a href="mem-aDDM.html#cb54-83" tabindex="-1"></a><span class="co"># set.seed(seed)</span></span>
<span id="cb54-84"><a href="mem-aDDM.html#cb54-84" tabindex="-1"></a><span class="co"># results &lt;- run.jags(</span></span>
<span id="cb54-85"><a href="mem-aDDM.html#cb54-85" tabindex="-1"></a><span class="co">#   model=&quot;temp/mem-aDDM_memaDDM.txt&quot;, </span></span>
<span id="cb54-86"><a href="mem-aDDM.html#cb54-86" tabindex="-1"></a><span class="co">#   monitor=monitor, </span></span>
<span id="cb54-87"><a href="mem-aDDM.html#cb54-87" tabindex="-1"></a><span class="co">#   data=dat, </span></span>
<span id="cb54-88"><a href="mem-aDDM.html#cb54-88" tabindex="-1"></a><span class="co">#   n.chains=3, </span></span>
<span id="cb54-89"><a href="mem-aDDM.html#cb54-89" tabindex="-1"></a><span class="co">#   inits=list(inits1,inits2,inits3),</span></span>
<span id="cb54-90"><a href="mem-aDDM.html#cb54-90" tabindex="-1"></a><span class="co">#   plots = TRUE, </span></span>
<span id="cb54-91"><a href="mem-aDDM.html#cb54-91" tabindex="-1"></a><span class="co">#   method=&quot;parallel&quot;, </span></span>
<span id="cb54-92"><a href="mem-aDDM.html#cb54-92" tabindex="-1"></a><span class="co">#   module=&quot;wiener&quot;, </span></span>
<span id="cb54-93"><a href="mem-aDDM.html#cb54-93" tabindex="-1"></a><span class="co">#   burnin=15000, sample=5000 #burnin=25000 sample=10000</span></span>
<span id="cb54-94"><a href="mem-aDDM.html#cb54-94" tabindex="-1"></a><span class="co"># ) </span></span>
<span id="cb54-95"><a href="mem-aDDM.html#cb54-95" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb54-96"><a href="mem-aDDM.html#cb54-96" tabindex="-1"></a><span class="co"># memFit &lt;- add.summary(results)</span></span>
<span id="cb54-97"><a href="mem-aDDM.html#cb54-97" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb54-98"><a href="mem-aDDM.html#cb54-98" tabindex="-1"></a><span class="co"># save(memFit, file=&quot;temp/mem-aDDM_memaDDMfit.RData&quot;)</span></span>
<span id="cb54-99"><a href="mem-aDDM.html#cb54-99" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb54-100"><a href="mem-aDDM.html#cb54-100" tabindex="-1"></a><span class="co"># # Convergence reached?</span></span>
<span id="cb54-101"><a href="mem-aDDM.html#cb54-101" tabindex="-1"></a><span class="co"># memFit$psrf$mpsrf</span></span></code></pre></div>
<p>Looks like we’re in the clear.</p>
</div>
<div id="map-estimates" class="section level3 hasAnchor" number="3.5.5">
<h3><span class="header-section-number">3.5.5</span> MAP estimates<a href="mem-aDDM.html#map-estimates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s get the mode and 95% HDI for each subject’s parameter estimates.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="mem-aDDM.html#cb55-1" tabindex="-1"></a><span class="co"># estimate and return the mode of a distribution (in this case, the posterior)</span></span>
<span id="cb55-2"><a href="mem-aDDM.html#cb55-2" tabindex="-1"></a>estimate_mode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb55-3"><a href="mem-aDDM.html#cb55-3" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">density</span>(x)</span>
<span id="cb55-4"><a href="mem-aDDM.html#cb55-4" tabindex="-1"></a>  <span class="fu">return</span>( d<span class="sc">$</span>x[<span class="fu">which.max</span>(d<span class="sc">$</span>y)] )</span>
<span id="cb55-5"><a href="mem-aDDM.html#cb55-5" tabindex="-1"></a>}</span>
<span id="cb55-6"><a href="mem-aDDM.html#cb55-6" tabindex="-1"></a></span>
<span id="cb55-7"><a href="mem-aDDM.html#cb55-7" tabindex="-1"></a><span class="co"># estimate 95 HDI</span></span>
<span id="cb55-8"><a href="mem-aDDM.html#cb55-8" tabindex="-1"></a>estimate_hdi <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">conf=</span>.<span class="dv">95</span>) {</span>
<span id="cb55-9"><a href="mem-aDDM.html#cb55-9" tabindex="-1"></a>  lb <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>conf)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb55-10"><a href="mem-aDDM.html#cb55-10" tabindex="-1"></a>  ub <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span><span class="sc">-</span>conf)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb55-11"><a href="mem-aDDM.html#cb55-11" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(lb,ub), <span class="at">na.rm =</span> F,</span>
<span id="cb55-12"><a href="mem-aDDM.html#cb55-12" tabindex="-1"></a>           <span class="at">names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-13"><a href="mem-aDDM.html#cb55-13" tabindex="-1"></a>  <span class="fu">return</span>(d)</span>
<span id="cb55-14"><a href="mem-aDDM.html#cb55-14" tabindex="-1"></a>}</span>
<span id="cb55-15"><a href="mem-aDDM.html#cb55-15" tabindex="-1"></a></span>
<span id="cb55-16"><a href="mem-aDDM.html#cb55-16" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span><span class="st">&quot;temp/mem-aDDM_memaDDMfit.RData&quot;</span>)</span>
<span id="cb55-17"><a href="mem-aDDM.html#cb55-17" tabindex="-1"></a></span>
<span id="cb55-18"><a href="mem-aDDM.html#cb55-18" tabindex="-1"></a><span class="co"># Get the traces</span></span>
<span id="cb55-19"><a href="mem-aDDM.html#cb55-19" tabindex="-1"></a>memtraces <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">combine.mcmc</span>(<span class="at">mcmc.objects=</span>memFit<span class="sc">$</span>mcmc))</span>
<span id="cb55-20"><a href="mem-aDDM.html#cb55-20" tabindex="-1"></a></span>
<span id="cb55-21"><a href="mem-aDDM.html#cb55-21" tabindex="-1"></a><span class="co"># placeholders</span></span>
<span id="cb55-22"><a href="mem-aDDM.html#cb55-22" tabindex="-1"></a>memMAP <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb55-23"><a href="mem-aDDM.html#cb55-23" tabindex="-1"></a>  <span class="at">d =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb55-24"><a href="mem-aDDM.html#cb55-24" tabindex="-1"></a>  <span class="at">d_lb =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb55-25"><a href="mem-aDDM.html#cb55-25" tabindex="-1"></a>  <span class="at">d_ub =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb55-26"><a href="mem-aDDM.html#cb55-26" tabindex="-1"></a>  <span class="at">g =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb55-27"><a href="mem-aDDM.html#cb55-27" tabindex="-1"></a>  <span class="at">g_lb =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb55-28"><a href="mem-aDDM.html#cb55-28" tabindex="-1"></a>  <span class="at">g_ub =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb55-29"><a href="mem-aDDM.html#cb55-29" tabindex="-1"></a>  <span class="at">sig =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb55-30"><a href="mem-aDDM.html#cb55-30" tabindex="-1"></a>  <span class="at">sig_lb =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb55-31"><a href="mem-aDDM.html#cb55-31" tabindex="-1"></a>  <span class="at">sig_ub =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb55-32"><a href="mem-aDDM.html#cb55-32" tabindex="-1"></a>  <span class="at">bias =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb55-33"><a href="mem-aDDM.html#cb55-33" tabindex="-1"></a>  <span class="at">bias_lb =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb55-34"><a href="mem-aDDM.html#cb55-34" tabindex="-1"></a>  <span class="at">bias_ub =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb55-35"><a href="mem-aDDM.html#cb55-35" tabindex="-1"></a>  <span class="at">theta =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb55-36"><a href="mem-aDDM.html#cb55-36" tabindex="-1"></a>  <span class="at">theta_lb =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb55-37"><a href="mem-aDDM.html#cb55-37" tabindex="-1"></a>  <span class="at">theta_ub =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber)</span>
<span id="cb55-38"><a href="mem-aDDM.html#cb55-38" tabindex="-1"></a>)</span>
<span id="cb55-39"><a href="mem-aDDM.html#cb55-39" tabindex="-1"></a></span>
<span id="cb55-40"><a href="mem-aDDM.html#cb55-40" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber)) {</span>
<span id="cb55-41"><a href="mem-aDDM.html#cb55-41" tabindex="-1"></a>  </span>
<span id="cb55-42"><a href="mem-aDDM.html#cb55-42" tabindex="-1"></a>  <span class="co"># column names</span></span>
<span id="cb55-43"><a href="mem-aDDM.html#cb55-43" tabindex="-1"></a>  d.ind <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;d.&#39;</span>,<span class="fu">toString</span>(j),<span class="st">&#39;.&#39;</span>)</span>
<span id="cb55-44"><a href="mem-aDDM.html#cb55-44" tabindex="-1"></a>  g.ind <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;g.&#39;</span>,<span class="fu">toString</span>(j),<span class="st">&#39;.&#39;</span>)</span>
<span id="cb55-45"><a href="mem-aDDM.html#cb55-45" tabindex="-1"></a>  sig.ind <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;sig.&#39;</span>,<span class="fu">toString</span>(j),<span class="st">&#39;.&#39;</span>)</span>
<span id="cb55-46"><a href="mem-aDDM.html#cb55-46" tabindex="-1"></a>  bias.ind <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;bias.&#39;</span>,<span class="fu">toString</span>(j),<span class="st">&#39;.&#39;</span>)</span>
<span id="cb55-47"><a href="mem-aDDM.html#cb55-47" tabindex="-1"></a>  theta.ind <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;theta.&#39;</span>,<span class="fu">toString</span>(j),<span class="st">&#39;.&#39;</span>)</span>
<span id="cb55-48"><a href="mem-aDDM.html#cb55-48" tabindex="-1"></a>  </span>
<span id="cb55-49"><a href="mem-aDDM.html#cb55-49" tabindex="-1"></a>  <span class="co"># Get modes</span></span>
<span id="cb55-50"><a href="mem-aDDM.html#cb55-50" tabindex="-1"></a>  memMAP<span class="sc">$</span>d[j]     <span class="ot">&lt;-</span> <span class="fu">estimate_mode</span>(memtraces[,d.ind])</span>
<span id="cb55-51"><a href="mem-aDDM.html#cb55-51" tabindex="-1"></a>  memMAP<span class="sc">$</span>g[j]     <span class="ot">&lt;-</span> <span class="fu">estimate_mode</span>(memtraces[,g.ind])</span>
<span id="cb55-52"><a href="mem-aDDM.html#cb55-52" tabindex="-1"></a>  memMAP<span class="sc">$</span>sig[j]   <span class="ot">&lt;-</span> <span class="fu">estimate_mode</span>(memtraces[,sig.ind])</span>
<span id="cb55-53"><a href="mem-aDDM.html#cb55-53" tabindex="-1"></a>  memMAP<span class="sc">$</span>bias[j]  <span class="ot">&lt;-</span> <span class="fu">estimate_mode</span>(memtraces[,bias.ind])</span>
<span id="cb55-54"><a href="mem-aDDM.html#cb55-54" tabindex="-1"></a>  memMAP<span class="sc">$</span>theta[j] <span class="ot">&lt;-</span> <span class="fu">estimate_mode</span>(memtraces[,theta.ind])</span>
<span id="cb55-55"><a href="mem-aDDM.html#cb55-55" tabindex="-1"></a>  </span>
<span id="cb55-56"><a href="mem-aDDM.html#cb55-56" tabindex="-1"></a>  <span class="co"># Get HDIs</span></span>
<span id="cb55-57"><a href="mem-aDDM.html#cb55-57" tabindex="-1"></a>  d_hdi     <span class="ot">&lt;-</span> <span class="fu">estimate_hdi</span>(memtraces[,d.ind])</span>
<span id="cb55-58"><a href="mem-aDDM.html#cb55-58" tabindex="-1"></a>  g_hdi     <span class="ot">&lt;-</span> <span class="fu">estimate_hdi</span>(memtraces[,g.ind])</span>
<span id="cb55-59"><a href="mem-aDDM.html#cb55-59" tabindex="-1"></a>  sig_hdi   <span class="ot">&lt;-</span> <span class="fu">estimate_hdi</span>(memtraces[,sig.ind])</span>
<span id="cb55-60"><a href="mem-aDDM.html#cb55-60" tabindex="-1"></a>  bias_hdi  <span class="ot">&lt;-</span> <span class="fu">estimate_hdi</span>(memtraces[,bias.ind])</span>
<span id="cb55-61"><a href="mem-aDDM.html#cb55-61" tabindex="-1"></a>  theta_hdi <span class="ot">&lt;-</span> <span class="fu">estimate_hdi</span>(memtraces[,theta.ind])</span>
<span id="cb55-62"><a href="mem-aDDM.html#cb55-62" tabindex="-1"></a>  memMAP<span class="sc">$</span>d_lb[j]     <span class="ot">&lt;-</span> d_hdi[<span class="dv">1</span>]</span>
<span id="cb55-63"><a href="mem-aDDM.html#cb55-63" tabindex="-1"></a>  memMAP<span class="sc">$</span>g_lb[j]     <span class="ot">&lt;-</span> g_hdi[<span class="dv">1</span>]</span>
<span id="cb55-64"><a href="mem-aDDM.html#cb55-64" tabindex="-1"></a>  memMAP<span class="sc">$</span>sig_lb[j]   <span class="ot">&lt;-</span> sig_hdi[<span class="dv">1</span>]</span>
<span id="cb55-65"><a href="mem-aDDM.html#cb55-65" tabindex="-1"></a>  memMAP<span class="sc">$</span>bias_lb[j]  <span class="ot">&lt;-</span> bias_hdi[<span class="dv">1</span>]</span>
<span id="cb55-66"><a href="mem-aDDM.html#cb55-66" tabindex="-1"></a>  memMAP<span class="sc">$</span>theta_lb[j] <span class="ot">&lt;-</span> theta_hdi[<span class="dv">1</span>]</span>
<span id="cb55-67"><a href="mem-aDDM.html#cb55-67" tabindex="-1"></a>  memMAP<span class="sc">$</span>d_ub[j]     <span class="ot">&lt;-</span> d_hdi[<span class="dv">2</span>]</span>
<span id="cb55-68"><a href="mem-aDDM.html#cb55-68" tabindex="-1"></a>  memMAP<span class="sc">$</span>g_ub[j]     <span class="ot">&lt;-</span> g_hdi[<span class="dv">2</span>]</span>
<span id="cb55-69"><a href="mem-aDDM.html#cb55-69" tabindex="-1"></a>  memMAP<span class="sc">$</span>sig_ub[j]   <span class="ot">&lt;-</span> sig_hdi[<span class="dv">2</span>]</span>
<span id="cb55-70"><a href="mem-aDDM.html#cb55-70" tabindex="-1"></a>  memMAP<span class="sc">$</span>bias_ub[j]  <span class="ot">&lt;-</span> bias_hdi[<span class="dv">2</span>]</span>
<span id="cb55-71"><a href="mem-aDDM.html#cb55-71" tabindex="-1"></a>  memMAP<span class="sc">$</span>theta_ub[j] <span class="ot">&lt;-</span> theta_hdi[<span class="dv">2</span>]</span>
<span id="cb55-72"><a href="mem-aDDM.html#cb55-72" tabindex="-1"></a>  </span>
<span id="cb55-73"><a href="mem-aDDM.html#cb55-73" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="addm" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> aDDM<a href="mem-aDDM.html#addm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We need something to compare the mem-aDDM to. The obvious benchmark is the aDDM since the mem-aDDM is an attempt to improve the RT fits of the aDDM.</p>
<div id="jags-code-1" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> JAGS code<a href="mem-aDDM.html#jags-code-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(RDV_t = RDV_{t-1} + d\mu+\epsilon\)</span></p>
<p>where <span class="math inline">\(\mu=(V_L-\theta V_R)\)</span> if looking left, and <span class="math inline">\(\mu=(\theta V_L-V_R)\)</span> if looking right. <span class="math inline">\(\epsilon \sim N(0,\sigma)\)</span> is white, Gaussian noise. <span class="math inline">\(\gamma\)</span> is sensitivity to previous time spent looking at either stimuli.</p>
<p>Don’t forget that JAGS rnorm works with precision… so confusing keeping track of what Stan or JAGS use…</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="mem-aDDM.html#cb56-1" tabindex="-1"></a><span class="fu">cat</span>( <span class="st">&quot;model {</span></span>
<span id="cb56-2"><a href="mem-aDDM.html#cb56-2" tabindex="-1"></a></span>
<span id="cb56-3"><a href="mem-aDDM.html#cb56-3" tabindex="-1"></a><span class="st">    # drift rate</span></span>
<span id="cb56-4"><a href="mem-aDDM.html#cb56-4" tabindex="-1"></a><span class="st">        d_mu ~ dunif(0.00001,50)</span></span>
<span id="cb56-5"><a href="mem-aDDM.html#cb56-5" tabindex="-1"></a><span class="st">        d_pr ~ dgamma(1, 0.1)</span></span>
<span id="cb56-6"><a href="mem-aDDM.html#cb56-6" tabindex="-1"></a></span>
<span id="cb56-7"><a href="mem-aDDM.html#cb56-7" tabindex="-1"></a><span class="st">    # noise</span></span>
<span id="cb56-8"><a href="mem-aDDM.html#cb56-8" tabindex="-1"></a><span class="st">        sig_mu ~ dunif(0.000001, 2)</span></span>
<span id="cb56-9"><a href="mem-aDDM.html#cb56-9" tabindex="-1"></a><span class="st">        sig_pr ~ dgamma(1, 0.1)</span></span>
<span id="cb56-10"><a href="mem-aDDM.html#cb56-10" tabindex="-1"></a></span>
<span id="cb56-11"><a href="mem-aDDM.html#cb56-11" tabindex="-1"></a><span class="st">    # Bias of the DDM</span></span>
<span id="cb56-12"><a href="mem-aDDM.html#cb56-12" tabindex="-1"></a><span class="st">        bias_alpha &lt;- bias_mu * bias_kappa</span></span>
<span id="cb56-13"><a href="mem-aDDM.html#cb56-13" tabindex="-1"></a><span class="st">        bias_beta &lt;- (1 - bias_mu) * bias_kappa</span></span>
<span id="cb56-14"><a href="mem-aDDM.html#cb56-14" tabindex="-1"></a><span class="st">        bias_mu ~ dbeta(2, 2)T(0.01,0.99)</span></span>
<span id="cb56-15"><a href="mem-aDDM.html#cb56-15" tabindex="-1"></a><span class="st">        bias_kappa ~ dgamma(1, 0.5)</span></span>
<span id="cb56-16"><a href="mem-aDDM.html#cb56-16" tabindex="-1"></a></span>
<span id="cb56-17"><a href="mem-aDDM.html#cb56-17" tabindex="-1"></a><span class="st">    # attentional bias</span></span>
<span id="cb56-18"><a href="mem-aDDM.html#cb56-18" tabindex="-1"></a><span class="st">        theta_mu ~ dnorm(.5,.3)T(0,1)</span></span>
<span id="cb56-19"><a href="mem-aDDM.html#cb56-19" tabindex="-1"></a><span class="st">        theta_pr ~ dgamma(1, 0.1)</span></span>
<span id="cb56-20"><a href="mem-aDDM.html#cb56-20" tabindex="-1"></a></span>
<span id="cb56-21"><a href="mem-aDDM.html#cb56-21" tabindex="-1"></a><span class="st">    for (p in 1:ns) { # subject level</span></span>
<span id="cb56-22"><a href="mem-aDDM.html#cb56-22" tabindex="-1"></a></span>
<span id="cb56-23"><a href="mem-aDDM.html#cb56-23" tabindex="-1"></a><span class="st">        d[p] ~ dnorm(d_mu, d_pr)T(0.000001,50)</span></span>
<span id="cb56-24"><a href="mem-aDDM.html#cb56-24" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb56-25"><a href="mem-aDDM.html#cb56-25" tabindex="-1"></a><span class="st">        sig[p] ~ dnorm(sig_mu, sig_pr)T(0.00001,2)</span></span>
<span id="cb56-26"><a href="mem-aDDM.html#cb56-26" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb56-27"><a href="mem-aDDM.html#cb56-27" tabindex="-1"></a><span class="st">        bias[p] ~ dbeta(bias_alpha, bias_beta)T(0.01,0.99)</span></span>
<span id="cb56-28"><a href="mem-aDDM.html#cb56-28" tabindex="-1"></a></span>
<span id="cb56-29"><a href="mem-aDDM.html#cb56-29" tabindex="-1"></a><span class="st">        theta[p] ~ dnorm(theta_mu, theta_pr)T(0,1)</span></span>
<span id="cb56-30"><a href="mem-aDDM.html#cb56-30" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb56-31"><a href="mem-aDDM.html#cb56-31" tabindex="-1"></a></span>
<span id="cb56-32"><a href="mem-aDDM.html#cb56-32" tabindex="-1"></a><span class="st">    for (i in 1:N) { # trial level</span></span>
<span id="cb56-33"><a href="mem-aDDM.html#cb56-33" tabindex="-1"></a></span>
<span id="cb56-34"><a href="mem-aDDM.html#cb56-34" tabindex="-1"></a><span class="st">    ## WIENER model, fixing the threshold to 2 and estimating the noise</span></span>
<span id="cb56-35"><a href="mem-aDDM.html#cb56-35" tabindex="-1"></a><span class="st">        y[i] ~ dwieners(2, tau[i], bet[i], w[i], sig[idxP[i]] ) # actual DDM distribution</span></span>
<span id="cb56-36"><a href="mem-aDDM.html#cb56-36" tabindex="-1"></a></span>
<span id="cb56-37"><a href="mem-aDDM.html#cb56-37" tabindex="-1"></a><span class="st">        # generate trial-by-trial nDT</span></span>
<span id="cb56-38"><a href="mem-aDDM.html#cb56-38" tabindex="-1"></a><span class="st">        tau[i] &lt;- ndt[i]</span></span>
<span id="cb56-39"><a href="mem-aDDM.html#cb56-39" tabindex="-1"></a></span>
<span id="cb56-40"><a href="mem-aDDM.html#cb56-40" tabindex="-1"></a><span class="st">        # generate trial-by-trial Bias</span></span>
<span id="cb56-41"><a href="mem-aDDM.html#cb56-41" tabindex="-1"></a><span class="st">        bet[i] &lt;- bias[idxP[i]]</span></span>
<span id="cb56-42"><a href="mem-aDDM.html#cb56-42" tabindex="-1"></a></span>
<span id="cb56-43"><a href="mem-aDDM.html#cb56-43" tabindex="-1"></a><span class="st">        # Drift rate</span></span>
<span id="cb56-44"><a href="mem-aDDM.html#cb56-44" tabindex="-1"></a><span class="st">        w[i] &lt;- d[idxP[i]] * ( (gazeL[i]*v_L[i] - (1-gazeL[i])*v_R[i]) + theta[idxP[i]]*((1-gazeL[i])*v_L[i] - gazeL[i]*v_R[i]))</span></span>
<span id="cb56-45"><a href="mem-aDDM.html#cb56-45" tabindex="-1"></a></span>
<span id="cb56-46"><a href="mem-aDDM.html#cb56-46" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb56-47"><a href="mem-aDDM.html#cb56-47" tabindex="-1"></a><span class="st">}&quot;</span>, <span class="at">file=</span><span class="st">&quot;temp/mem-aDDM_aDDM.txt&quot;</span>)</span></code></pre></div>
</div>
<div id="fit-addm" class="section level3 hasAnchor" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Fit aDDM<a href="mem-aDDM.html#fit-addm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use odd trials as training data. At the end, check whether all distributions have converged with Gelman-Rubin statistics.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="mem-aDDM.html#cb57-1" tabindex="-1"></a><span class="co"># initial guesses</span></span>
<span id="cb57-2"><a href="mem-aDDM.html#cb57-2" tabindex="-1"></a>inits1 <span class="ot">&lt;-</span> <span class="fu">dump.format</span>(<span class="fu">list</span>( </span>
<span id="cb57-3"><a href="mem-aDDM.html#cb57-3" tabindex="-1"></a>  <span class="at">d_mu=</span><span class="fl">0.2</span>, <span class="at">d_pr=</span><span class="fl">0.05</span>,</span>
<span id="cb57-4"><a href="mem-aDDM.html#cb57-4" tabindex="-1"></a>  <span class="at">sig_mu=</span><span class="dv">1</span>,<span class="at">sig_pr=</span><span class="dv">1</span>,</span>
<span id="cb57-5"><a href="mem-aDDM.html#cb57-5" tabindex="-1"></a>  <span class="at">bias_mu=</span><span class="fl">0.5</span>, <span class="at">bias_kappa=</span><span class="dv">1</span>,</span>
<span id="cb57-6"><a href="mem-aDDM.html#cb57-6" tabindex="-1"></a>  <span class="at">theta_mu=</span><span class="fl">0.6</span>,<span class="at">theta_pr=</span><span class="fl">0.5</span>,</span>
<span id="cb57-7"><a href="mem-aDDM.html#cb57-7" tabindex="-1"></a>  <span class="at">.RNG.name=</span><span class="st">&quot;base::Super-Duper&quot;</span>, <span class="at">.RNG.seed=</span><span class="dv">1</span></span>
<span id="cb57-8"><a href="mem-aDDM.html#cb57-8" tabindex="-1"></a>))</span>
<span id="cb57-9"><a href="mem-aDDM.html#cb57-9" tabindex="-1"></a></span>
<span id="cb57-10"><a href="mem-aDDM.html#cb57-10" tabindex="-1"></a>inits2 <span class="ot">&lt;-</span> <span class="fu">dump.format</span>(<span class="fu">list</span>( </span>
<span id="cb57-11"><a href="mem-aDDM.html#cb57-11" tabindex="-1"></a>  <span class="at">d_mu=</span><span class="fl">0.1</span>, <span class="at">d_pr=</span><span class="fl">0.05</span>,</span>
<span id="cb57-12"><a href="mem-aDDM.html#cb57-12" tabindex="-1"></a>  <span class="at">sig_mu=</span><span class="dv">1</span>,<span class="at">sig_pr=</span><span class="dv">1</span>,</span>
<span id="cb57-13"><a href="mem-aDDM.html#cb57-13" tabindex="-1"></a>  <span class="at">bias_mu=</span><span class="fl">0.6</span>, <span class="at">bias_kappa=</span><span class="dv">1</span>,</span>
<span id="cb57-14"><a href="mem-aDDM.html#cb57-14" tabindex="-1"></a>  <span class="at">theta_mu=</span><span class="fl">0.5</span>,<span class="at">theta_pr=</span><span class="fl">0.5</span>,</span>
<span id="cb57-15"><a href="mem-aDDM.html#cb57-15" tabindex="-1"></a>  <span class="at">.RNG.name=</span><span class="st">&quot;base::Wichmann-Hill&quot;</span>, <span class="at">.RNG.seed=</span><span class="dv">2</span></span>
<span id="cb57-16"><a href="mem-aDDM.html#cb57-16" tabindex="-1"></a>))</span>
<span id="cb57-17"><a href="mem-aDDM.html#cb57-17" tabindex="-1"></a></span>
<span id="cb57-18"><a href="mem-aDDM.html#cb57-18" tabindex="-1"></a>inits3 <span class="ot">&lt;-</span> <span class="fu">dump.format</span>(<span class="fu">list</span>( </span>
<span id="cb57-19"><a href="mem-aDDM.html#cb57-19" tabindex="-1"></a>  <span class="at">d_mu=</span><span class="fl">0.05</span>, <span class="at">d_pr=</span><span class="fl">0.05</span>,</span>
<span id="cb57-20"><a href="mem-aDDM.html#cb57-20" tabindex="-1"></a>  <span class="at">sig_mu=</span><span class="dv">1</span>,<span class="at">sig_pr=</span><span class="dv">1</span>,</span>
<span id="cb57-21"><a href="mem-aDDM.html#cb57-21" tabindex="-1"></a>  <span class="at">bias_mu=</span><span class="fl">0.4</span>, <span class="at">bias_kappa=</span><span class="dv">1</span>,</span>
<span id="cb57-22"><a href="mem-aDDM.html#cb57-22" tabindex="-1"></a>  <span class="at">theta_mu=</span><span class="fl">0.2</span>,<span class="at">theta_pr=</span><span class="fl">0.5</span>,</span>
<span id="cb57-23"><a href="mem-aDDM.html#cb57-23" tabindex="-1"></a>  <span class="at">.RNG.name=</span><span class="st">&quot;base::Mersenne-Twister&quot;</span>, <span class="at">.RNG.seed=</span><span class="dv">3</span></span>
<span id="cb57-24"><a href="mem-aDDM.html#cb57-24" tabindex="-1"></a>))</span>
<span id="cb57-25"><a href="mem-aDDM.html#cb57-25" tabindex="-1"></a></span>
<span id="cb57-26"><a href="mem-aDDM.html#cb57-26" tabindex="-1"></a><span class="co"># parameters to monitor</span></span>
<span id="cb57-27"><a href="mem-aDDM.html#cb57-27" tabindex="-1"></a>monitor <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb57-28"><a href="mem-aDDM.html#cb57-28" tabindex="-1"></a>  <span class="st">&quot;d_mu&quot;</span>, <span class="st">&quot;d_pr&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="co"># drift rate</span></span>
<span id="cb57-29"><a href="mem-aDDM.html#cb57-29" tabindex="-1"></a>  <span class="st">&quot;sig_mu&quot;</span>, <span class="st">&quot;sig_pr&quot;</span>, <span class="st">&quot;sig&quot;</span>, <span class="co"># noise </span></span>
<span id="cb57-30"><a href="mem-aDDM.html#cb57-30" tabindex="-1"></a>  <span class="st">&quot;bias_mu&quot;</span>, <span class="st">&quot;bias_kappa&quot;</span>, <span class="st">&quot;bias&quot;</span>, <span class="co"># bias</span></span>
<span id="cb57-31"><a href="mem-aDDM.html#cb57-31" tabindex="-1"></a>  <span class="st">&quot;theta_mu&quot;</span>, <span class="st">&quot;theta_pr&quot;</span>, <span class="st">&quot;theta&quot;</span> <span class="co"># attentional discounting</span></span>
<span id="cb57-32"><a href="mem-aDDM.html#cb57-32" tabindex="-1"></a>)</span>
<span id="cb57-33"><a href="mem-aDDM.html#cb57-33" tabindex="-1"></a></span>
<span id="cb57-34"><a href="mem-aDDM.html#cb57-34" tabindex="-1"></a><span class="co"># run the fitting</span></span>
<span id="cb57-35"><a href="mem-aDDM.html#cb57-35" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb57-36"><a href="mem-aDDM.html#cb57-36" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">run.jags</span>(</span>
<span id="cb57-37"><a href="mem-aDDM.html#cb57-37" tabindex="-1"></a>  <span class="at">model=</span><span class="st">&quot;temp/mem-aDDM_aDDM.txt&quot;</span>,</span>
<span id="cb57-38"><a href="mem-aDDM.html#cb57-38" tabindex="-1"></a>  <span class="at">monitor=</span>monitor,</span>
<span id="cb57-39"><a href="mem-aDDM.html#cb57-39" tabindex="-1"></a>  <span class="at">data=</span>dat,</span>
<span id="cb57-40"><a href="mem-aDDM.html#cb57-40" tabindex="-1"></a>  <span class="at">n.chains=</span><span class="dv">3</span>,</span>
<span id="cb57-41"><a href="mem-aDDM.html#cb57-41" tabindex="-1"></a>  <span class="at">inits=</span><span class="fu">list</span>(inits1,inits2,inits3),</span>
<span id="cb57-42"><a href="mem-aDDM.html#cb57-42" tabindex="-1"></a>  <span class="at">plots =</span> <span class="cn">TRUE</span>,</span>
<span id="cb57-43"><a href="mem-aDDM.html#cb57-43" tabindex="-1"></a>  <span class="at">method=</span><span class="st">&quot;parallel&quot;</span>,</span>
<span id="cb57-44"><a href="mem-aDDM.html#cb57-44" tabindex="-1"></a>  <span class="at">module=</span><span class="st">&quot;wiener&quot;</span>,</span>
<span id="cb57-45"><a href="mem-aDDM.html#cb57-45" tabindex="-1"></a>  <span class="at">burnin=</span><span class="dv">15000</span>, <span class="at">sample=</span><span class="dv">5000</span></span>
<span id="cb57-46"><a href="mem-aDDM.html#cb57-46" tabindex="-1"></a>)</span>
<span id="cb57-47"><a href="mem-aDDM.html#cb57-47" tabindex="-1"></a></span>
<span id="cb57-48"><a href="mem-aDDM.html#cb57-48" tabindex="-1"></a>aFit <span class="ot">&lt;-</span> <span class="fu">add.summary</span>(results)</span>
<span id="cb57-49"><a href="mem-aDDM.html#cb57-49" tabindex="-1"></a></span>
<span id="cb57-50"><a href="mem-aDDM.html#cb57-50" tabindex="-1"></a><span class="fu">save</span>(aFit, <span class="at">file=</span><span class="st">&quot;temp/mem-aDDM_aDDMfit.RData&quot;</span>)</span>
<span id="cb57-51"><a href="mem-aDDM.html#cb57-51" tabindex="-1"></a></span>
<span id="cb57-52"><a href="mem-aDDM.html#cb57-52" tabindex="-1"></a><span class="co"># Convergence reached?</span></span>
<span id="cb57-53"><a href="mem-aDDM.html#cb57-53" tabindex="-1"></a>aFit<span class="sc">$</span>psrf<span class="sc">$</span>mpsrf</span></code></pre></div>
<p>Looks like we’re in the clear.</p>
</div>
<div id="map-estimates-1" class="section level3 hasAnchor" number="3.6.3">
<h3><span class="header-section-number">3.6.3</span> MAP estimates<a href="mem-aDDM.html#map-estimates-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s get the mode and 95% HDI for each subject’s parameter estimates.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="mem-aDDM.html#cb58-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span><span class="st">&quot;temp/mem-aDDM_aDDMfit.RData&quot;</span>)</span>
<span id="cb58-2"><a href="mem-aDDM.html#cb58-2" tabindex="-1"></a></span>
<span id="cb58-3"><a href="mem-aDDM.html#cb58-3" tabindex="-1"></a><span class="co"># Get the traces</span></span>
<span id="cb58-4"><a href="mem-aDDM.html#cb58-4" tabindex="-1"></a>atraces <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">combine.mcmc</span>(<span class="at">mcmc.objects=</span>aFit<span class="sc">$</span>mcmc))</span>
<span id="cb58-5"><a href="mem-aDDM.html#cb58-5" tabindex="-1"></a></span>
<span id="cb58-6"><a href="mem-aDDM.html#cb58-6" tabindex="-1"></a><span class="co"># placeholders</span></span>
<span id="cb58-7"><a href="mem-aDDM.html#cb58-7" tabindex="-1"></a>aMAP <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb58-8"><a href="mem-aDDM.html#cb58-8" tabindex="-1"></a>  <span class="at">d =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb58-9"><a href="mem-aDDM.html#cb58-9" tabindex="-1"></a>  <span class="at">d_lb =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb58-10"><a href="mem-aDDM.html#cb58-10" tabindex="-1"></a>  <span class="at">d_ub =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb58-11"><a href="mem-aDDM.html#cb58-11" tabindex="-1"></a>  <span class="at">sig =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb58-12"><a href="mem-aDDM.html#cb58-12" tabindex="-1"></a>  <span class="at">sig_lb =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb58-13"><a href="mem-aDDM.html#cb58-13" tabindex="-1"></a>  <span class="at">sig_ub =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb58-14"><a href="mem-aDDM.html#cb58-14" tabindex="-1"></a>  <span class="at">bias =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb58-15"><a href="mem-aDDM.html#cb58-15" tabindex="-1"></a>  <span class="at">bias_lb =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb58-16"><a href="mem-aDDM.html#cb58-16" tabindex="-1"></a>  <span class="at">bias_ub =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb58-17"><a href="mem-aDDM.html#cb58-17" tabindex="-1"></a>  <span class="at">theta =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb58-18"><a href="mem-aDDM.html#cb58-18" tabindex="-1"></a>  <span class="at">theta_lb =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber),</span>
<span id="cb58-19"><a href="mem-aDDM.html#cb58-19" tabindex="-1"></a>  <span class="at">theta_ub =</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber)</span>
<span id="cb58-20"><a href="mem-aDDM.html#cb58-20" tabindex="-1"></a>)</span>
<span id="cb58-21"><a href="mem-aDDM.html#cb58-21" tabindex="-1"></a></span>
<span id="cb58-22"><a href="mem-aDDM.html#cb58-22" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">unique</span>(food<span class="sc">$</span>SubjectNumber)) {</span>
<span id="cb58-23"><a href="mem-aDDM.html#cb58-23" tabindex="-1"></a>  </span>
<span id="cb58-24"><a href="mem-aDDM.html#cb58-24" tabindex="-1"></a>  <span class="co"># column names</span></span>
<span id="cb58-25"><a href="mem-aDDM.html#cb58-25" tabindex="-1"></a>  d.ind <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;d.&#39;</span>,<span class="fu">toString</span>(j),<span class="st">&#39;.&#39;</span>)</span>
<span id="cb58-26"><a href="mem-aDDM.html#cb58-26" tabindex="-1"></a>  sig.ind <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;sig.&#39;</span>,<span class="fu">toString</span>(j),<span class="st">&#39;.&#39;</span>)</span>
<span id="cb58-27"><a href="mem-aDDM.html#cb58-27" tabindex="-1"></a>  bias.ind <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;bias.&#39;</span>,<span class="fu">toString</span>(j),<span class="st">&#39;.&#39;</span>)</span>
<span id="cb58-28"><a href="mem-aDDM.html#cb58-28" tabindex="-1"></a>  theta.ind <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;theta.&#39;</span>,<span class="fu">toString</span>(j),<span class="st">&#39;.&#39;</span>)</span>
<span id="cb58-29"><a href="mem-aDDM.html#cb58-29" tabindex="-1"></a>  </span>
<span id="cb58-30"><a href="mem-aDDM.html#cb58-30" tabindex="-1"></a>  <span class="co"># Get modes</span></span>
<span id="cb58-31"><a href="mem-aDDM.html#cb58-31" tabindex="-1"></a>  aMAP<span class="sc">$</span>d[j]     <span class="ot">&lt;-</span> <span class="fu">estimate_mode</span>(atraces[,d.ind])</span>
<span id="cb58-32"><a href="mem-aDDM.html#cb58-32" tabindex="-1"></a>  aMAP<span class="sc">$</span>sig[j]   <span class="ot">&lt;-</span> <span class="fu">estimate_mode</span>(atraces[,sig.ind])</span>
<span id="cb58-33"><a href="mem-aDDM.html#cb58-33" tabindex="-1"></a>  aMAP<span class="sc">$</span>bias[j]  <span class="ot">&lt;-</span> <span class="fu">estimate_mode</span>(atraces[,bias.ind])</span>
<span id="cb58-34"><a href="mem-aDDM.html#cb58-34" tabindex="-1"></a>  aMAP<span class="sc">$</span>theta[j] <span class="ot">&lt;-</span> <span class="fu">estimate_mode</span>(atraces[,theta.ind])</span>
<span id="cb58-35"><a href="mem-aDDM.html#cb58-35" tabindex="-1"></a>  </span>
<span id="cb58-36"><a href="mem-aDDM.html#cb58-36" tabindex="-1"></a>  <span class="co"># Get HDIs</span></span>
<span id="cb58-37"><a href="mem-aDDM.html#cb58-37" tabindex="-1"></a>  d_hdi     <span class="ot">&lt;-</span> <span class="fu">estimate_hdi</span>(atraces[,d.ind])</span>
<span id="cb58-38"><a href="mem-aDDM.html#cb58-38" tabindex="-1"></a>  sig_hdi   <span class="ot">&lt;-</span> <span class="fu">estimate_hdi</span>(atraces[,sig.ind])</span>
<span id="cb58-39"><a href="mem-aDDM.html#cb58-39" tabindex="-1"></a>  bias_hdi  <span class="ot">&lt;-</span> <span class="fu">estimate_hdi</span>(atraces[,bias.ind])</span>
<span id="cb58-40"><a href="mem-aDDM.html#cb58-40" tabindex="-1"></a>  theta_hdi <span class="ot">&lt;-</span> <span class="fu">estimate_hdi</span>(atraces[,theta.ind])</span>
<span id="cb58-41"><a href="mem-aDDM.html#cb58-41" tabindex="-1"></a>  aMAP<span class="sc">$</span>d_lb[j]     <span class="ot">&lt;-</span> d_hdi[<span class="dv">1</span>]</span>
<span id="cb58-42"><a href="mem-aDDM.html#cb58-42" tabindex="-1"></a>  aMAP<span class="sc">$</span>sig_lb[j]   <span class="ot">&lt;-</span> sig_hdi[<span class="dv">1</span>]</span>
<span id="cb58-43"><a href="mem-aDDM.html#cb58-43" tabindex="-1"></a>  aMAP<span class="sc">$</span>bias_lb[j]  <span class="ot">&lt;-</span> bias_hdi[<span class="dv">1</span>]</span>
<span id="cb58-44"><a href="mem-aDDM.html#cb58-44" tabindex="-1"></a>  aMAP<span class="sc">$</span>theta_lb[j] <span class="ot">&lt;-</span> theta_hdi[<span class="dv">1</span>]</span>
<span id="cb58-45"><a href="mem-aDDM.html#cb58-45" tabindex="-1"></a>  aMAP<span class="sc">$</span>d_ub[j]     <span class="ot">&lt;-</span> d_hdi[<span class="dv">2</span>]</span>
<span id="cb58-46"><a href="mem-aDDM.html#cb58-46" tabindex="-1"></a>  aMAP<span class="sc">$</span>sig_ub[j]   <span class="ot">&lt;-</span> sig_hdi[<span class="dv">2</span>]</span>
<span id="cb58-47"><a href="mem-aDDM.html#cb58-47" tabindex="-1"></a>  aMAP<span class="sc">$</span>bias_ub[j]  <span class="ot">&lt;-</span> bias_hdi[<span class="dv">2</span>]</span>
<span id="cb58-48"><a href="mem-aDDM.html#cb58-48" tabindex="-1"></a>  aMAP<span class="sc">$</span>theta_ub[j] <span class="ot">&lt;-</span> theta_hdi[<span class="dv">2</span>]</span>
<span id="cb58-49"><a href="mem-aDDM.html#cb58-49" tabindex="-1"></a>  </span>
<span id="cb58-50"><a href="mem-aDDM.html#cb58-50" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="compare-predictions" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Compare predictions<a href="mem-aDDM.html#compare-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="mem-addm-trial-simulation" class="section level3 hasAnchor" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> mem-aDDM trial simulation<a href="mem-aDDM.html#mem-addm-trial-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write a function that simulates behavior (choice, rt) for a single trial using the mem-aDDM. It will take as inputs parameters to the mem-aDDM and fixation properties (e.g. probability of first fixating left which is a scalar, or middle fixations which is the distribution of all middle fixations for that subject from the testing set).</p>
<p>This is code taken from <span class="citation">(<a href="#ref-eum2022">Eum, Dolbier, and Rangel 2022</a>)</span>, which is code based on <span class="citation">(<a href="#ref-lombardi2021">Lombardi and Hare 2021</a>)</span>.</p>
<p>Note that the mem-aDDM nests the original aDDM. If you want to run an aDDM trial, all you need to do is feed in g=c(0). This eliminates any effect of previous encounter in the algorithm!</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="mem-aDDM.html#cb59-1" tabindex="-1"></a>mem.sim.trial <span class="ot">&lt;-</span> <span class="cf">function</span>(b, d, g, t, s, vL, vR, pe, prFirstLeft, firstFix, middleFix, latency, transition) {</span>
<span id="cb59-2"><a href="mem-aDDM.html#cb59-2" tabindex="-1"></a>  </span>
<span id="cb59-3"><a href="mem-aDDM.html#cb59-3" tabindex="-1"></a>  <span class="do">###################################################################</span></span>
<span id="cb59-4"><a href="mem-aDDM.html#cb59-4" tabindex="-1"></a>  <span class="co"># create a variable to track when to stop (for efficiency purposes)</span></span>
<span id="cb59-5"><a href="mem-aDDM.html#cb59-5" tabindex="-1"></a>  stopper <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb59-6"><a href="mem-aDDM.html#cb59-6" tabindex="-1"></a>  </span>
<span id="cb59-7"><a href="mem-aDDM.html#cb59-7" tabindex="-1"></a>  <span class="do">##############################</span></span>
<span id="cb59-8"><a href="mem-aDDM.html#cb59-8" tabindex="-1"></a>  <span class="co"># initialize rdv at bias point</span></span>
<span id="cb59-9"><a href="mem-aDDM.html#cb59-9" tabindex="-1"></a>  RDV <span class="ot">&lt;-</span> b</span>
<span id="cb59-10"><a href="mem-aDDM.html#cb59-10" tabindex="-1"></a>  rt  <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb59-11"><a href="mem-aDDM.html#cb59-11" tabindex="-1"></a>  </span>
<span id="cb59-12"><a href="mem-aDDM.html#cb59-12" tabindex="-1"></a>  <span class="do">##############################</span></span>
<span id="cb59-13"><a href="mem-aDDM.html#cb59-13" tabindex="-1"></a>  <span class="co"># latency to first fixation</span></span>
<span id="cb59-14"><a href="mem-aDDM.html#cb59-14" tabindex="-1"></a>  latencyDur <span class="ot">&lt;-</span> <span class="fu">sample</span>(latency,<span class="dv">1</span>)</span>
<span id="cb59-15"><a href="mem-aDDM.html#cb59-15" tabindex="-1"></a>  latency_err <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>latencyDur, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span>s)</span>
<span id="cb59-16"><a href="mem-aDDM.html#cb59-16" tabindex="-1"></a>  </span>
<span id="cb59-17"><a href="mem-aDDM.html#cb59-17" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(RDV<span class="sc">+</span><span class="fu">sum</span>(latency_err))<span class="sc">&gt;=</span><span class="dv">1</span>) {</span>
<span id="cb59-18"><a href="mem-aDDM.html#cb59-18" tabindex="-1"></a>    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>latencyDur) {</span>
<span id="cb59-19"><a href="mem-aDDM.html#cb59-19" tabindex="-1"></a>      RDV <span class="ot">&lt;-</span> RDV <span class="sc">+</span> latency_err[t]</span>
<span id="cb59-20"><a href="mem-aDDM.html#cb59-20" tabindex="-1"></a>      rt <span class="ot">&lt;-</span> rt <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb59-21"><a href="mem-aDDM.html#cb59-21" tabindex="-1"></a>      lastLoc <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb59-22"><a href="mem-aDDM.html#cb59-22" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">abs</span>(RDV)<span class="sc">&gt;=</span><span class="dv">1</span>) {stopper<span class="ot">&lt;-</span><span class="dv">1</span>; <span class="cf">break</span>}</span>
<span id="cb59-23"><a href="mem-aDDM.html#cb59-23" tabindex="-1"></a>    }</span>
<span id="cb59-24"><a href="mem-aDDM.html#cb59-24" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb59-25"><a href="mem-aDDM.html#cb59-25" tabindex="-1"></a>    RDV <span class="ot">&lt;-</span> RDV <span class="sc">+</span> <span class="fu">sum</span>(latency_err)</span>
<span id="cb59-26"><a href="mem-aDDM.html#cb59-26" tabindex="-1"></a>    rt <span class="ot">&lt;-</span> rt <span class="sc">+</span> latencyDur</span>
<span id="cb59-27"><a href="mem-aDDM.html#cb59-27" tabindex="-1"></a>  }</span>
<span id="cb59-28"><a href="mem-aDDM.html#cb59-28" tabindex="-1"></a>  </span>
<span id="cb59-29"><a href="mem-aDDM.html#cb59-29" tabindex="-1"></a>  <span class="do">##############################</span></span>
<span id="cb59-30"><a href="mem-aDDM.html#cb59-30" tabindex="-1"></a>  <span class="co"># first fixation</span></span>
<span id="cb59-31"><a href="mem-aDDM.html#cb59-31" tabindex="-1"></a>  <span class="cf">if</span> (stopper<span class="sc">==</span><span class="dv">0</span>) {</span>
<span id="cb59-32"><a href="mem-aDDM.html#cb59-32" tabindex="-1"></a>    firstDur <span class="ot">&lt;-</span> <span class="fu">sample</span>(firstFix,<span class="dv">1</span>)</span>
<span id="cb59-33"><a href="mem-aDDM.html#cb59-33" tabindex="-1"></a>    loc <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">1</span>,prFirstLeft)</span>
<span id="cb59-34"><a href="mem-aDDM.html#cb59-34" tabindex="-1"></a>    <span class="cf">if</span> (loc<span class="sc">==</span><span class="dv">1</span>) {drift_mean <span class="ot">&lt;-</span> (d<span class="sc">+</span>g<span class="sc">*</span>pe)<span class="sc">*</span>(vL<span class="sc">-</span>t<span class="sc">*</span>vR)}</span>
<span id="cb59-35"><a href="mem-aDDM.html#cb59-35" tabindex="-1"></a>    <span class="cf">if</span> (loc<span class="sc">==</span><span class="dv">0</span>) {drift_mean <span class="ot">&lt;-</span> (d<span class="sc">+</span>g<span class="sc">*</span>pe)<span class="sc">*</span>(t<span class="sc">*</span>vL<span class="sc">-</span>vR)}</span>
<span id="cb59-36"><a href="mem-aDDM.html#cb59-36" tabindex="-1"></a>    drift <span class="ot">&lt;-</span> drift_mean <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n=</span>firstDur, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span>s)</span>
<span id="cb59-37"><a href="mem-aDDM.html#cb59-37" tabindex="-1"></a>  </span>
<span id="cb59-38"><a href="mem-aDDM.html#cb59-38" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(RDV<span class="sc">+</span><span class="fu">sum</span>(drift))<span class="sc">&gt;=</span><span class="dv">1</span>) {</span>
<span id="cb59-39"><a href="mem-aDDM.html#cb59-39" tabindex="-1"></a>      <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>firstDur) {</span>
<span id="cb59-40"><a href="mem-aDDM.html#cb59-40" tabindex="-1"></a>        RDV <span class="ot">&lt;-</span> RDV <span class="sc">+</span> drift[t]</span>
<span id="cb59-41"><a href="mem-aDDM.html#cb59-41" tabindex="-1"></a>        rt <span class="ot">&lt;-</span> rt <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb59-42"><a href="mem-aDDM.html#cb59-42" tabindex="-1"></a>        lastLoc <span class="ot">&lt;-</span> loc</span>
<span id="cb59-43"><a href="mem-aDDM.html#cb59-43" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">abs</span>(RDV)<span class="sc">&gt;=</span><span class="dv">1</span>) {stopper<span class="ot">&lt;-</span><span class="dv">1</span>; <span class="cf">break</span>}</span>
<span id="cb59-44"><a href="mem-aDDM.html#cb59-44" tabindex="-1"></a>      }</span>
<span id="cb59-45"><a href="mem-aDDM.html#cb59-45" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb59-46"><a href="mem-aDDM.html#cb59-46" tabindex="-1"></a>      RDV <span class="ot">&lt;-</span> RDV <span class="sc">+</span> <span class="fu">sum</span>(drift)</span>
<span id="cb59-47"><a href="mem-aDDM.html#cb59-47" tabindex="-1"></a>      rt <span class="ot">&lt;-</span> rt <span class="sc">+</span> firstDur</span>
<span id="cb59-48"><a href="mem-aDDM.html#cb59-48" tabindex="-1"></a>      prevLoc <span class="ot">&lt;-</span> loc</span>
<span id="cb59-49"><a href="mem-aDDM.html#cb59-49" tabindex="-1"></a>    }</span>
<span id="cb59-50"><a href="mem-aDDM.html#cb59-50" tabindex="-1"></a>  }</span>
<span id="cb59-51"><a href="mem-aDDM.html#cb59-51" tabindex="-1"></a>  </span>
<span id="cb59-52"><a href="mem-aDDM.html#cb59-52" tabindex="-1"></a>  <span class="do">#######################################################</span></span>
<span id="cb59-53"><a href="mem-aDDM.html#cb59-53" tabindex="-1"></a>  <span class="co"># transitions and middle fixations until choice is made</span></span>
<span id="cb59-54"><a href="mem-aDDM.html#cb59-54" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(RDV)<span class="sc">&lt;</span><span class="dv">1</span>) {</span>
<span id="cb59-55"><a href="mem-aDDM.html#cb59-55" tabindex="-1"></a>    transDur <span class="ot">&lt;-</span> <span class="fu">sample</span>(transition,<span class="dv">1</span>)</span>
<span id="cb59-56"><a href="mem-aDDM.html#cb59-56" tabindex="-1"></a>    trans_err <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>transDur, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span>s)</span>
<span id="cb59-57"><a href="mem-aDDM.html#cb59-57" tabindex="-1"></a>    </span>
<span id="cb59-58"><a href="mem-aDDM.html#cb59-58" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(RDV<span class="sc">+</span><span class="fu">sum</span>(trans_err))<span class="sc">&gt;=</span><span class="dv">1</span>) {</span>
<span id="cb59-59"><a href="mem-aDDM.html#cb59-59" tabindex="-1"></a>      <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>transDur) {</span>
<span id="cb59-60"><a href="mem-aDDM.html#cb59-60" tabindex="-1"></a>        RDV <span class="ot">&lt;-</span> RDV <span class="sc">+</span> trans_err[t]</span>
<span id="cb59-61"><a href="mem-aDDM.html#cb59-61" tabindex="-1"></a>        rt <span class="ot">&lt;-</span> rt <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb59-62"><a href="mem-aDDM.html#cb59-62" tabindex="-1"></a>        lastLoc <span class="ot">&lt;-</span> prevLoc</span>
<span id="cb59-63"><a href="mem-aDDM.html#cb59-63" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">abs</span>(RDV)<span class="sc">&gt;=</span><span class="dv">1</span>) {stopper<span class="ot">&lt;-</span><span class="dv">1</span>; <span class="cf">break</span>}</span>
<span id="cb59-64"><a href="mem-aDDM.html#cb59-64" tabindex="-1"></a>      }</span>
<span id="cb59-65"><a href="mem-aDDM.html#cb59-65" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb59-66"><a href="mem-aDDM.html#cb59-66" tabindex="-1"></a>      RDV <span class="ot">&lt;-</span> RDV <span class="sc">+</span> <span class="fu">sum</span>(trans_err)</span>
<span id="cb59-67"><a href="mem-aDDM.html#cb59-67" tabindex="-1"></a>      rt <span class="ot">&lt;-</span> rt <span class="sc">+</span> transDur</span>
<span id="cb59-68"><a href="mem-aDDM.html#cb59-68" tabindex="-1"></a>    }</span>
<span id="cb59-69"><a href="mem-aDDM.html#cb59-69" tabindex="-1"></a>    </span>
<span id="cb59-70"><a href="mem-aDDM.html#cb59-70" tabindex="-1"></a>    <span class="cf">if</span> (stopper<span class="sc">==</span><span class="dv">0</span>) {</span>
<span id="cb59-71"><a href="mem-aDDM.html#cb59-71" tabindex="-1"></a>      middleDur <span class="ot">&lt;-</span> <span class="fu">sample</span>(middleFix,<span class="dv">1</span>)</span>
<span id="cb59-72"><a href="mem-aDDM.html#cb59-72" tabindex="-1"></a>      <span class="cf">if</span> (prevLoc<span class="sc">==</span><span class="dv">1</span>) {loc<span class="ot">&lt;-</span><span class="dv">0</span>}</span>
<span id="cb59-73"><a href="mem-aDDM.html#cb59-73" tabindex="-1"></a>      <span class="cf">if</span> (prevLoc<span class="sc">==</span><span class="dv">0</span>) {loc<span class="ot">&lt;-</span><span class="dv">1</span>}</span>
<span id="cb59-74"><a href="mem-aDDM.html#cb59-74" tabindex="-1"></a>      <span class="cf">if</span> (loc<span class="sc">==</span><span class="dv">1</span>) {drift_mean <span class="ot">&lt;-</span> (d<span class="sc">+</span>g<span class="sc">*</span>pe)<span class="sc">*</span>(vL<span class="sc">-</span>t<span class="sc">*</span>vR)}</span>
<span id="cb59-75"><a href="mem-aDDM.html#cb59-75" tabindex="-1"></a>      <span class="cf">if</span> (loc<span class="sc">==</span><span class="dv">0</span>) {drift_mean <span class="ot">&lt;-</span> (d<span class="sc">+</span>g<span class="sc">*</span>pe)<span class="sc">*</span>(t<span class="sc">*</span>vL<span class="sc">-</span>vR)}</span>
<span id="cb59-76"><a href="mem-aDDM.html#cb59-76" tabindex="-1"></a>      drift <span class="ot">&lt;-</span> drift_mean <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n=</span>middleDur, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span>s)</span>
<span id="cb59-77"><a href="mem-aDDM.html#cb59-77" tabindex="-1"></a>    </span>
<span id="cb59-78"><a href="mem-aDDM.html#cb59-78" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">abs</span>(RDV<span class="sc">+</span><span class="fu">sum</span>(drift))<span class="sc">&gt;=</span><span class="dv">1</span>) {</span>
<span id="cb59-79"><a href="mem-aDDM.html#cb59-79" tabindex="-1"></a>        <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>middleDur) {</span>
<span id="cb59-80"><a href="mem-aDDM.html#cb59-80" tabindex="-1"></a>          RDV <span class="ot">&lt;-</span> RDV <span class="sc">+</span> drift[t]</span>
<span id="cb59-81"><a href="mem-aDDM.html#cb59-81" tabindex="-1"></a>          rt <span class="ot">&lt;-</span> rt <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb59-82"><a href="mem-aDDM.html#cb59-82" tabindex="-1"></a>          lastLoc <span class="ot">&lt;-</span> loc</span>
<span id="cb59-83"><a href="mem-aDDM.html#cb59-83" tabindex="-1"></a>          <span class="cf">if</span> (<span class="fu">abs</span>(RDV)<span class="sc">&gt;=</span><span class="dv">1</span>) {<span class="cf">break</span>}</span>
<span id="cb59-84"><a href="mem-aDDM.html#cb59-84" tabindex="-1"></a>        }</span>
<span id="cb59-85"><a href="mem-aDDM.html#cb59-85" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb59-86"><a href="mem-aDDM.html#cb59-86" tabindex="-1"></a>        RDV <span class="ot">&lt;-</span> RDV <span class="sc">+</span> <span class="fu">sum</span>(drift)</span>
<span id="cb59-87"><a href="mem-aDDM.html#cb59-87" tabindex="-1"></a>        rt <span class="ot">&lt;-</span> rt <span class="sc">+</span> middleDur</span>
<span id="cb59-88"><a href="mem-aDDM.html#cb59-88" tabindex="-1"></a>        prevLoc <span class="ot">&lt;-</span> loc</span>
<span id="cb59-89"><a href="mem-aDDM.html#cb59-89" tabindex="-1"></a>      }</span>
<span id="cb59-90"><a href="mem-aDDM.html#cb59-90" tabindex="-1"></a>    }</span>
<span id="cb59-91"><a href="mem-aDDM.html#cb59-91" tabindex="-1"></a>  }</span>
<span id="cb59-92"><a href="mem-aDDM.html#cb59-92" tabindex="-1"></a></span>
<span id="cb59-93"><a href="mem-aDDM.html#cb59-93" tabindex="-1"></a>  <span class="do">##############################</span></span>
<span id="cb59-94"><a href="mem-aDDM.html#cb59-94" tabindex="-1"></a>  <span class="co"># return your results</span></span>
<span id="cb59-95"><a href="mem-aDDM.html#cb59-95" tabindex="-1"></a>  <span class="cf">if</span> (RDV<span class="sc">&gt;</span><span class="dv">0</span>) {choice <span class="ot">&lt;-</span> <span class="dv">1</span>}</span>
<span id="cb59-96"><a href="mem-aDDM.html#cb59-96" tabindex="-1"></a>  <span class="cf">if</span> (RDV<span class="sc">&lt;</span><span class="dv">0</span>) {choice <span class="ot">&lt;-</span> <span class="dv">0</span>}</span>
<span id="cb59-97"><a href="mem-aDDM.html#cb59-97" tabindex="-1"></a>  vDiff <span class="ot">&lt;-</span> vL<span class="sc">*</span><span class="dv">10</span><span class="sc">-</span>vR<span class="sc">*</span><span class="dv">10</span></span>
<span id="cb59-98"><a href="mem-aDDM.html#cb59-98" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">choice=</span>choice, <span class="at">rt=</span>rt<span class="sc">/</span><span class="dv">1000</span>, <span class="at">vL=</span>vL<span class="sc">*</span><span class="dv">10</span>, <span class="at">vR=</span>vR<span class="sc">*</span><span class="dv">10</span>, <span class="at">vDiff=</span>vDiff, <span class="at">lastFix=</span>lastLoc)</span>
<span id="cb59-99"><a href="mem-aDDM.html#cb59-99" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb59-100"><a href="mem-aDDM.html#cb59-100" tabindex="-1"></a>  </span>
<span id="cb59-101"><a href="mem-aDDM.html#cb59-101" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="out-of-sample-predictions" class="section level3 hasAnchor" number="3.7.2">
<h3><span class="header-section-number">3.7.2</span> Out-of-sample predictions<a href="mem-aDDM.html#out-of-sample-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Simulate</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="mem-aDDM.html#cb60-1" tabindex="-1"></a>simCount <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb60-2"><a href="mem-aDDM.html#cb60-2" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb60-3"><a href="mem-aDDM.html#cb60-3" tabindex="-1"></a></span>
<span id="cb60-4"><a href="mem-aDDM.html#cb60-4" tabindex="-1"></a><span class="co"># fixation data from out-of-sample</span></span>
<span id="cb60-5"><a href="mem-aDDM.html#cb60-5" tabindex="-1"></a>fixeven <span class="ot">&lt;-</span> food[food<span class="sc">$</span>Trial<span class="sc">%%</span><span class="dv">2</span><span class="sc">==</span><span class="dv">0</span>,]</span>
<span id="cb60-6"><a href="mem-aDDM.html#cb60-6" tabindex="-1"></a></span>
<span id="cb60-7"><a href="mem-aDDM.html#cb60-7" tabindex="-1"></a><span class="co"># Placeholders</span></span>
<span id="cb60-8"><a href="mem-aDDM.html#cb60-8" tabindex="-1"></a>vL <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb60-9"><a href="mem-aDDM.html#cb60-9" tabindex="-1"></a>vR <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb60-10"><a href="mem-aDDM.html#cb60-10" tabindex="-1"></a>pe <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb60-11"><a href="mem-aDDM.html#cb60-11" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb60-12"><a href="mem-aDDM.html#cb60-12" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb60-13"><a href="mem-aDDM.html#cb60-13" tabindex="-1"></a>sig <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb60-14"><a href="mem-aDDM.html#cb60-14" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb60-15"><a href="mem-aDDM.html#cb60-15" tabindex="-1"></a>bias <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb60-16"><a href="mem-aDDM.html#cb60-16" tabindex="-1"></a>prFirstLeft <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb60-17"><a href="mem-aDDM.html#cb60-17" tabindex="-1"></a>latency <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb60-18"><a href="mem-aDDM.html#cb60-18" tabindex="-1"></a>firstFix <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb60-19"><a href="mem-aDDM.html#cb60-19" tabindex="-1"></a>transition <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb60-20"><a href="mem-aDDM.html#cb60-20" tabindex="-1"></a>middleFix <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb60-21"><a href="mem-aDDM.html#cb60-21" tabindex="-1"></a></span>
<span id="cb60-22"><a href="mem-aDDM.html#cb60-22" tabindex="-1"></a>mem.sim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-23"><a href="mem-aDDM.html#cb60-23" tabindex="-1"></a>  <span class="at">subj =</span> <span class="cn">NA</span>,</span>
<span id="cb60-24"><a href="mem-aDDM.html#cb60-24" tabindex="-1"></a>  <span class="at">trial =</span> <span class="cn">NA</span>,</span>
<span id="cb60-25"><a href="mem-aDDM.html#cb60-25" tabindex="-1"></a>  <span class="at">choice =</span> <span class="cn">NA</span>,</span>
<span id="cb60-26"><a href="mem-aDDM.html#cb60-26" tabindex="-1"></a>  <span class="at">choice.a =</span> <span class="cn">NA</span>,</span>
<span id="cb60-27"><a href="mem-aDDM.html#cb60-27" tabindex="-1"></a>  <span class="at">rt =</span> <span class="cn">NA</span>,</span>
<span id="cb60-28"><a href="mem-aDDM.html#cb60-28" tabindex="-1"></a>  <span class="at">rt.a=</span><span class="cn">NA</span>,</span>
<span id="cb60-29"><a href="mem-aDDM.html#cb60-29" tabindex="-1"></a>  <span class="at">vL =</span> <span class="cn">NA</span>,</span>
<span id="cb60-30"><a href="mem-aDDM.html#cb60-30" tabindex="-1"></a>  <span class="at">vR =</span> <span class="cn">NA</span>,</span>
<span id="cb60-31"><a href="mem-aDDM.html#cb60-31" tabindex="-1"></a>  <span class="at">vDiff =</span> <span class="cn">NA</span>,</span>
<span id="cb60-32"><a href="mem-aDDM.html#cb60-32" tabindex="-1"></a>  <span class="at">simulation =</span> <span class="cn">NA</span>,</span>
<span id="cb60-33"><a href="mem-aDDM.html#cb60-33" tabindex="-1"></a>  <span class="at">lastFix =</span> <span class="cn">NA</span>,</span>
<span id="cb60-34"><a href="mem-aDDM.html#cb60-34" tabindex="-1"></a>  <span class="at">lastFix.a =</span> <span class="cn">NA</span>,</span>
<span id="cb60-35"><a href="mem-aDDM.html#cb60-35" tabindex="-1"></a>  <span class="at">pe=</span><span class="cn">NA</span></span>
<span id="cb60-36"><a href="mem-aDDM.html#cb60-36" tabindex="-1"></a>)</span>
<span id="cb60-37"><a href="mem-aDDM.html#cb60-37" tabindex="-1"></a></span>
<span id="cb60-38"><a href="mem-aDDM.html#cb60-38" tabindex="-1"></a><span class="co"># Loop through subjects to get everyone&#39;s choices and RT</span></span>
<span id="cb60-39"><a href="mem-aDDM.html#cb60-39" tabindex="-1"></a><span class="cf">for</span> (sub <span class="cf">in</span> <span class="fu">sort</span>(<span class="fu">unique</span>(test<span class="sc">$</span>subject))) {</span>
<span id="cb60-40"><a href="mem-aDDM.html#cb60-40" tabindex="-1"></a>  </span>
<span id="cb60-41"><a href="mem-aDDM.html#cb60-41" tabindex="-1"></a>  <span class="co"># Progress tracker</span></span>
<span id="cb60-42"><a href="mem-aDDM.html#cb60-42" tabindex="-1"></a>  <span class="fu">print</span>(sub)</span>
<span id="cb60-43"><a href="mem-aDDM.html#cb60-43" tabindex="-1"></a>  </span>
<span id="cb60-44"><a href="mem-aDDM.html#cb60-44" tabindex="-1"></a>  <span class="co"># gather relevant data</span></span>
<span id="cb60-45"><a href="mem-aDDM.html#cb60-45" tabindex="-1"></a>  subjdata <span class="ot">&lt;-</span> test[test<span class="sc">$</span>subject<span class="sc">==</span>sub,]</span>
<span id="cb60-46"><a href="mem-aDDM.html#cb60-46" tabindex="-1"></a>  vL[[sub]] <span class="ot">&lt;-</span> subjdata<span class="sc">$</span>v_L</span>
<span id="cb60-47"><a href="mem-aDDM.html#cb60-47" tabindex="-1"></a>  vR[[sub]] <span class="ot">&lt;-</span> subjdata<span class="sc">$</span>v_R</span>
<span id="cb60-48"><a href="mem-aDDM.html#cb60-48" tabindex="-1"></a>  pe[[sub]] <span class="ot">&lt;-</span> subjdata<span class="sc">$</span>pe</span>
<span id="cb60-49"><a href="mem-aDDM.html#cb60-49" tabindex="-1"></a>  </span>
<span id="cb60-50"><a href="mem-aDDM.html#cb60-50" tabindex="-1"></a>  d.ind <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;d.&#39;</span>,<span class="fu">toString</span>(sub),<span class="st">&#39;.&#39;</span>)</span>
<span id="cb60-51"><a href="mem-aDDM.html#cb60-51" tabindex="-1"></a>  g.ind <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;g.&#39;</span>,<span class="fu">toString</span>(sub),<span class="st">&#39;.&#39;</span>)</span>
<span id="cb60-52"><a href="mem-aDDM.html#cb60-52" tabindex="-1"></a>  sig.ind <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;sig.&#39;</span>,<span class="fu">toString</span>(sub),<span class="st">&#39;.&#39;</span>)</span>
<span id="cb60-53"><a href="mem-aDDM.html#cb60-53" tabindex="-1"></a>  bias.ind <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;bias.&#39;</span>,<span class="fu">toString</span>(sub),<span class="st">&#39;.&#39;</span>)</span>
<span id="cb60-54"><a href="mem-aDDM.html#cb60-54" tabindex="-1"></a>  theta.ind <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;theta.&#39;</span>,<span class="fu">toString</span>(sub),<span class="st">&#39;.&#39;</span>)</span>
<span id="cb60-55"><a href="mem-aDDM.html#cb60-55" tabindex="-1"></a>  </span>
<span id="cb60-56"><a href="mem-aDDM.html#cb60-56" tabindex="-1"></a>  <span class="co"># convert all parameters to 1 ms timestep (originally in 1 s timestep)</span></span>
<span id="cb60-57"><a href="mem-aDDM.html#cb60-57" tabindex="-1"></a>  d[[sub]]     <span class="ot">&lt;-</span> <span class="fu">sample</span>(memtraces[,d.ind], simCount)<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb60-58"><a href="mem-aDDM.html#cb60-58" tabindex="-1"></a>  g[[sub]]     <span class="ot">&lt;-</span> <span class="fu">sample</span>(memtraces[,g.ind], simCount)<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb60-59"><a href="mem-aDDM.html#cb60-59" tabindex="-1"></a>  sig[[sub]]   <span class="ot">&lt;-</span> <span class="fu">sample</span>(memtraces[,sig.ind], simCount)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1000</span>)</span>
<span id="cb60-60"><a href="mem-aDDM.html#cb60-60" tabindex="-1"></a>  bias[[sub]]  <span class="ot">&lt;-</span> (<span class="fu">sample</span>(memtraces[,bias.ind], simCount)<span class="sc">-</span><span class="fl">0.5</span>)<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb60-61"><a href="mem-aDDM.html#cb60-61" tabindex="-1"></a>  theta[[sub]] <span class="ot">&lt;-</span> <span class="fu">sample</span>(memtraces[,theta.ind], simCount) </span>
<span id="cb60-62"><a href="mem-aDDM.html#cb60-62" tabindex="-1"></a>  </span>
<span id="cb60-63"><a href="mem-aDDM.html#cb60-63" tabindex="-1"></a>  subjfix <span class="ot">&lt;-</span> fixeven[fixeven<span class="sc">$</span>SubjectNumber<span class="sc">==</span>sub,]</span>
<span id="cb60-64"><a href="mem-aDDM.html#cb60-64" tabindex="-1"></a>  prFirstLeft[[sub]] <span class="ot">&lt;-</span> <span class="fu">mean</span>( (subjfix<span class="sc">$</span>ROI[subjfix<span class="sc">$</span>fixNum<span class="sc">==</span><span class="dv">1</span>]<span class="sc">==</span><span class="dv">1</span>) ,<span class="at">na.rm=</span>T)</span>
<span id="cb60-65"><a href="mem-aDDM.html#cb60-65" tabindex="-1"></a>  latency[[sub]] <span class="ot">&lt;-</span> test<span class="sc">$</span>ndt <span class="co">#capturing both latency and transitions</span></span>
<span id="cb60-66"><a href="mem-aDDM.html#cb60-66" tabindex="-1"></a>  firstFix[[sub]] <span class="ot">&lt;-</span> <span class="fu">round</span>(subjfix<span class="sc">$</span>DwellLength[subjfix<span class="sc">$</span>fixNum<span class="sc">==</span><span class="dv">1</span>]<span class="sc">*</span><span class="dv">1000</span>,<span class="dv">0</span>)</span>
<span id="cb60-67"><a href="mem-aDDM.html#cb60-67" tabindex="-1"></a>  transition[[sub]] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb60-68"><a href="mem-aDDM.html#cb60-68" tabindex="-1"></a>  middleFix[[sub]] <span class="ot">&lt;-</span> <span class="fu">round</span>(subjfix<span class="sc">$</span>DwellLength[subjfix<span class="sc">$</span>middleFix<span class="sc">==</span><span class="dv">1</span>]<span class="sc">*</span><span class="dv">1000</span>,<span class="dv">0</span>)</span>
<span id="cb60-69"><a href="mem-aDDM.html#cb60-69" tabindex="-1"></a>  </span>
<span id="cb60-70"><a href="mem-aDDM.html#cb60-70" tabindex="-1"></a>  <span class="co"># Simulate dataset</span></span>
<span id="cb60-71"><a href="mem-aDDM.html#cb60-71" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>simCount) {</span>
<span id="cb60-72"><a href="mem-aDDM.html#cb60-72" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(vL[[sub]])) {</span>
<span id="cb60-73"><a href="mem-aDDM.html#cb60-73" tabindex="-1"></a>      </span>
<span id="cb60-74"><a href="mem-aDDM.html#cb60-74" tabindex="-1"></a>      simTrial <span class="ot">&lt;-</span> <span class="fu">mem.sim.trial</span>(</span>
<span id="cb60-75"><a href="mem-aDDM.html#cb60-75" tabindex="-1"></a>          <span class="at">b =</span> bias[[sub]][j],</span>
<span id="cb60-76"><a href="mem-aDDM.html#cb60-76" tabindex="-1"></a>          <span class="at">d =</span> d[[sub]][j],</span>
<span id="cb60-77"><a href="mem-aDDM.html#cb60-77" tabindex="-1"></a>          <span class="at">g =</span> g[[sub]][j],</span>
<span id="cb60-78"><a href="mem-aDDM.html#cb60-78" tabindex="-1"></a>          <span class="at">t =</span> theta[[sub]][j],</span>
<span id="cb60-79"><a href="mem-aDDM.html#cb60-79" tabindex="-1"></a>          <span class="at">s =</span> sig[[sub]][j],</span>
<span id="cb60-80"><a href="mem-aDDM.html#cb60-80" tabindex="-1"></a>          <span class="at">vL =</span> vL[[sub]][i],</span>
<span id="cb60-81"><a href="mem-aDDM.html#cb60-81" tabindex="-1"></a>          <span class="at">vR =</span> vR[[sub]][i],</span>
<span id="cb60-82"><a href="mem-aDDM.html#cb60-82" tabindex="-1"></a>          <span class="at">pe =</span> pe[[sub]][[i]],</span>
<span id="cb60-83"><a href="mem-aDDM.html#cb60-83" tabindex="-1"></a>          <span class="at">prFirstLeft =</span> prFirstLeft[[sub]],</span>
<span id="cb60-84"><a href="mem-aDDM.html#cb60-84" tabindex="-1"></a>          <span class="at">latency =</span> latency[[sub]],</span>
<span id="cb60-85"><a href="mem-aDDM.html#cb60-85" tabindex="-1"></a>          <span class="at">transition =</span> transition[[sub]],</span>
<span id="cb60-86"><a href="mem-aDDM.html#cb60-86" tabindex="-1"></a>          <span class="at">firstFix =</span> firstFix[[sub]],</span>
<span id="cb60-87"><a href="mem-aDDM.html#cb60-87" tabindex="-1"></a>          <span class="at">middleFix =</span> middleFix[[sub]]</span>
<span id="cb60-88"><a href="mem-aDDM.html#cb60-88" tabindex="-1"></a>      )</span>
<span id="cb60-89"><a href="mem-aDDM.html#cb60-89" tabindex="-1"></a>      </span>
<span id="cb60-90"><a href="mem-aDDM.html#cb60-90" tabindex="-1"></a>      asimTrial <span class="ot">&lt;-</span> <span class="fu">mem.sim.trial</span>(</span>
<span id="cb60-91"><a href="mem-aDDM.html#cb60-91" tabindex="-1"></a>          <span class="at">b =</span> bias[[sub]][j],</span>
<span id="cb60-92"><a href="mem-aDDM.html#cb60-92" tabindex="-1"></a>          <span class="at">d =</span> d[[sub]][j],</span>
<span id="cb60-93"><a href="mem-aDDM.html#cb60-93" tabindex="-1"></a>          <span class="at">g =</span> <span class="fu">c</span>(<span class="dv">0</span>), <span class="co"># again, aDDM is nested in mem-aDDM (i.e. g=0).</span></span>
<span id="cb60-94"><a href="mem-aDDM.html#cb60-94" tabindex="-1"></a>          <span class="at">t =</span> theta[[sub]][j],</span>
<span id="cb60-95"><a href="mem-aDDM.html#cb60-95" tabindex="-1"></a>          <span class="at">s =</span> sig[[sub]][j],</span>
<span id="cb60-96"><a href="mem-aDDM.html#cb60-96" tabindex="-1"></a>          <span class="at">vL =</span> vL[[sub]][i],</span>
<span id="cb60-97"><a href="mem-aDDM.html#cb60-97" tabindex="-1"></a>          <span class="at">vR =</span> vR[[sub]][i],</span>
<span id="cb60-98"><a href="mem-aDDM.html#cb60-98" tabindex="-1"></a>          <span class="at">pe =</span> <span class="fu">c</span>(<span class="dv">0</span>),</span>
<span id="cb60-99"><a href="mem-aDDM.html#cb60-99" tabindex="-1"></a>          <span class="at">prFirstLeft =</span> prFirstLeft[[sub]],</span>
<span id="cb60-100"><a href="mem-aDDM.html#cb60-100" tabindex="-1"></a>          <span class="at">latency =</span> latency[[sub]],</span>
<span id="cb60-101"><a href="mem-aDDM.html#cb60-101" tabindex="-1"></a>          <span class="at">transition =</span> transition[[sub]],</span>
<span id="cb60-102"><a href="mem-aDDM.html#cb60-102" tabindex="-1"></a>          <span class="at">firstFix =</span> firstFix[[sub]],</span>
<span id="cb60-103"><a href="mem-aDDM.html#cb60-103" tabindex="-1"></a>          <span class="at">middleFix =</span> middleFix[[sub]]</span>
<span id="cb60-104"><a href="mem-aDDM.html#cb60-104" tabindex="-1"></a>      )</span>
<span id="cb60-105"><a href="mem-aDDM.html#cb60-105" tabindex="-1"></a>      simTrial<span class="sc">$</span>choice.a <span class="ot">&lt;-</span> asimTrial<span class="sc">$</span>choice</span>
<span id="cb60-106"><a href="mem-aDDM.html#cb60-106" tabindex="-1"></a>      simTrial<span class="sc">$</span>rt.a <span class="ot">&lt;-</span> asimTrial<span class="sc">$</span>rt</span>
<span id="cb60-107"><a href="mem-aDDM.html#cb60-107" tabindex="-1"></a>      simTrial<span class="sc">$</span>lastFix.a <span class="ot">&lt;-</span> asimTrial<span class="sc">$</span>lastFix</span>
<span id="cb60-108"><a href="mem-aDDM.html#cb60-108" tabindex="-1"></a>      </span>
<span id="cb60-109"><a href="mem-aDDM.html#cb60-109" tabindex="-1"></a>      simTrial<span class="sc">$</span>subj <span class="ot">&lt;-</span> sub</span>
<span id="cb60-110"><a href="mem-aDDM.html#cb60-110" tabindex="-1"></a>      simTrial<span class="sc">$</span>trial <span class="ot">&lt;-</span> i</span>
<span id="cb60-111"><a href="mem-aDDM.html#cb60-111" tabindex="-1"></a>      simTrial<span class="sc">$</span>simulation <span class="ot">&lt;-</span> j</span>
<span id="cb60-112"><a href="mem-aDDM.html#cb60-112" tabindex="-1"></a>      simTrial<span class="sc">$</span>pe <span class="ot">&lt;-</span> pe[[sub]][[i]]</span>
<span id="cb60-113"><a href="mem-aDDM.html#cb60-113" tabindex="-1"></a>      mem.sim <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mem.sim, simTrial)</span>
<span id="cb60-114"><a href="mem-aDDM.html#cb60-114" tabindex="-1"></a>    }</span>
<span id="cb60-115"><a href="mem-aDDM.html#cb60-115" tabindex="-1"></a>  }</span>
<span id="cb60-116"><a href="mem-aDDM.html#cb60-116" tabindex="-1"></a>}</span>
<span id="cb60-117"><a href="mem-aDDM.html#cb60-117" tabindex="-1"></a>mem.sim <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(mem.sim)</span>
<span id="cb60-118"><a href="mem-aDDM.html#cb60-118" tabindex="-1"></a></span>
<span id="cb60-119"><a href="mem-aDDM.html#cb60-119" tabindex="-1"></a><span class="fu">save</span>(mem.sim, <span class="at">file=</span><span class="st">&quot;temp/mem-aDDM_sim.RData&quot;</span>)</span></code></pre></div>
<p>I want two plots, each with 3 lines. One plot for choices. One plot for RTs. One line will show true out-of-sample data. One line will show mem-aDDM predictions for those exact same trials. One line will show aDDM predictions for those exact same trials. Run 20 simulations.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="mem-aDDM.html#cb61-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span><span class="st">&quot;temp/mem-aDDM_sim.RData&quot;</span>)</span>
<span id="cb61-2"><a href="mem-aDDM.html#cb61-2" tabindex="-1"></a></span>
<span id="cb61-3"><a href="mem-aDDM.html#cb61-3" tabindex="-1"></a>pdata.real <span class="ot">&lt;-</span> test <span class="sc">%&gt;%</span></span>
<span id="cb61-4"><a href="mem-aDDM.html#cb61-4" tabindex="-1"></a>  <span class="fu">group_by</span>(subject, vDiff) <span class="sc">%&gt;%</span></span>
<span id="cb61-5"><a href="mem-aDDM.html#cb61-5" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb61-6"><a href="mem-aDDM.html#cb61-6" tabindex="-1"></a>    <span class="at">choices =</span> <span class="fu">mean</span>(choice, <span class="at">na.rm=</span>T),</span>
<span id="cb61-7"><a href="mem-aDDM.html#cb61-7" tabindex="-1"></a>    <span class="at">rts =</span> <span class="fu">mean</span>(rt, <span class="at">na.rm=</span>T)</span>
<span id="cb61-8"><a href="mem-aDDM.html#cb61-8" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb61-9"><a href="mem-aDDM.html#cb61-9" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-10"><a href="mem-aDDM.html#cb61-10" tabindex="-1"></a>  <span class="fu">group_by</span>(vDiff) <span class="sc">%&gt;%</span></span>
<span id="cb61-11"><a href="mem-aDDM.html#cb61-11" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb61-12"><a href="mem-aDDM.html#cb61-12" tabindex="-1"></a>    <span class="at">choice.mean =</span> <span class="fu">mean</span>(choices, <span class="at">na.rm=</span>T),</span>
<span id="cb61-13"><a href="mem-aDDM.html#cb61-13" tabindex="-1"></a>    <span class="at">choice.se =</span> <span class="fu">std.error</span>(choices, <span class="at">na.rm=</span>T),</span>
<span id="cb61-14"><a href="mem-aDDM.html#cb61-14" tabindex="-1"></a>    <span class="at">rt.mean =</span> <span class="fu">mean</span>(rts, <span class="at">na.rm=</span>T),</span>
<span id="cb61-15"><a href="mem-aDDM.html#cb61-15" tabindex="-1"></a>    <span class="at">rt.se =</span> <span class="fu">std.error</span>(rts, <span class="at">na.rm=</span>T),</span>
<span id="cb61-16"><a href="mem-aDDM.html#cb61-16" tabindex="-1"></a>    <span class="at">Dataset =</span> <span class="dv">0</span></span>
<span id="cb61-17"><a href="mem-aDDM.html#cb61-17" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;subject&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="mem-aDDM.html#cb63-1" tabindex="-1"></a>pdata.real<span class="sc">$</span>vDiff <span class="ot">&lt;-</span> pdata.real<span class="sc">$</span>vDiff<span class="sc">*</span><span class="dv">10</span></span>
<span id="cb63-2"><a href="mem-aDDM.html#cb63-2" tabindex="-1"></a>pdata.mem <span class="ot">&lt;-</span> mem.sim <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="mem-aDDM.html#cb63-3" tabindex="-1"></a>  <span class="fu">group_by</span>(subj, vDiff) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="mem-aDDM.html#cb63-4" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb63-5"><a href="mem-aDDM.html#cb63-5" tabindex="-1"></a>    <span class="at">choices =</span> <span class="fu">mean</span>(choice, <span class="at">na.rm=</span>T),</span>
<span id="cb63-6"><a href="mem-aDDM.html#cb63-6" tabindex="-1"></a>    <span class="at">rts =</span> <span class="fu">mean</span>(rt, <span class="at">na.rm=</span>T)</span>
<span id="cb63-7"><a href="mem-aDDM.html#cb63-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb63-8"><a href="mem-aDDM.html#cb63-8" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-9"><a href="mem-aDDM.html#cb63-9" tabindex="-1"></a>  <span class="fu">group_by</span>(vDiff) <span class="sc">%&gt;%</span></span>
<span id="cb63-10"><a href="mem-aDDM.html#cb63-10" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb63-11"><a href="mem-aDDM.html#cb63-11" tabindex="-1"></a>    <span class="at">choice.mean =</span> <span class="fu">mean</span>(choices, <span class="at">na.rm=</span>T),</span>
<span id="cb63-12"><a href="mem-aDDM.html#cb63-12" tabindex="-1"></a>    <span class="at">choice.se =</span> <span class="fu">std.error</span>(choices, <span class="at">na.rm=</span>T),</span>
<span id="cb63-13"><a href="mem-aDDM.html#cb63-13" tabindex="-1"></a>    <span class="at">rt.mean =</span> <span class="fu">mean</span>(rts, <span class="at">na.rm=</span>T),</span>
<span id="cb63-14"><a href="mem-aDDM.html#cb63-14" tabindex="-1"></a>    <span class="at">rt.se =</span> <span class="fu">std.error</span>(rts, <span class="at">na.rm=</span>T),</span>
<span id="cb63-15"><a href="mem-aDDM.html#cb63-15" tabindex="-1"></a>    <span class="at">Dataset =</span> <span class="dv">1</span></span>
<span id="cb63-16"><a href="mem-aDDM.html#cb63-16" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;subj&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="mem-aDDM.html#cb65-1" tabindex="-1"></a>pdata.a <span class="ot">&lt;-</span> mem.sim <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="mem-aDDM.html#cb65-2" tabindex="-1"></a>  <span class="fu">group_by</span>(subj, vDiff) <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="mem-aDDM.html#cb65-3" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb65-4"><a href="mem-aDDM.html#cb65-4" tabindex="-1"></a>    <span class="at">choices =</span> <span class="fu">mean</span>(choice.a, <span class="at">na.rm=</span>T),</span>
<span id="cb65-5"><a href="mem-aDDM.html#cb65-5" tabindex="-1"></a>    <span class="at">rts =</span> <span class="fu">mean</span>(rt.a, <span class="at">na.rm=</span>T)</span>
<span id="cb65-6"><a href="mem-aDDM.html#cb65-6" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb65-7"><a href="mem-aDDM.html#cb65-7" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-8"><a href="mem-aDDM.html#cb65-8" tabindex="-1"></a>  <span class="fu">group_by</span>(vDiff) <span class="sc">%&gt;%</span></span>
<span id="cb65-9"><a href="mem-aDDM.html#cb65-9" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb65-10"><a href="mem-aDDM.html#cb65-10" tabindex="-1"></a>    <span class="at">choice.mean =</span> <span class="fu">mean</span>(choices, <span class="at">na.rm=</span>T),</span>
<span id="cb65-11"><a href="mem-aDDM.html#cb65-11" tabindex="-1"></a>    <span class="at">choice.se =</span> <span class="fu">std.error</span>(choices, <span class="at">na.rm=</span>T),</span>
<span id="cb65-12"><a href="mem-aDDM.html#cb65-12" tabindex="-1"></a>    <span class="at">rt.mean =</span> <span class="fu">mean</span>(rts, <span class="at">na.rm=</span>T),</span>
<span id="cb65-13"><a href="mem-aDDM.html#cb65-13" tabindex="-1"></a>    <span class="at">rt.se =</span> <span class="fu">std.error</span>(rts, <span class="at">na.rm=</span>T),</span>
<span id="cb65-14"><a href="mem-aDDM.html#cb65-14" tabindex="-1"></a>    <span class="at">Dataset =</span> <span class="dv">2</span></span>
<span id="cb65-15"><a href="mem-aDDM.html#cb65-15" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;subj&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="mem-aDDM.html#cb67-1" tabindex="-1"></a>pdata <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pdata.real, pdata.mem)</span>
<span id="cb67-2"><a href="mem-aDDM.html#cb67-2" tabindex="-1"></a>pdata <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pdata, pdata.a)</span>
<span id="cb67-3"><a href="mem-aDDM.html#cb67-3" tabindex="-1"></a>pdata<span class="sc">$</span>Dataset <span class="ot">&lt;-</span> <span class="fu">factor</span>(pdata<span class="sc">$</span>Dataset, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>,<span class="st">&quot;mem-aDDM Sim.&quot;</span>,<span class="st">&quot;aDDM Sim.&quot;</span>))</span>
<span id="cb67-4"><a href="mem-aDDM.html#cb67-4" tabindex="-1"></a></span>
<span id="cb67-5"><a href="mem-aDDM.html#cb67-5" tabindex="-1"></a>mem.choice.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>pdata, <span class="fu">aes</span>(<span class="at">x=</span>vDiff)) <span class="sc">+</span></span>
<span id="cb67-6"><a href="mem-aDDM.html#cb67-6" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">&#39;grey&#39;</span>, <span class="at">alpha=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb67-7"><a href="mem-aDDM.html#cb67-7" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">&#39;grey&#39;</span>, <span class="at">alpha=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb67-8"><a href="mem-aDDM.html#cb67-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>choice.mean, <span class="at">group=</span>Dataset, <span class="at">color=</span>Dataset), <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb67-9"><a href="mem-aDDM.html#cb67-9" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>choice.mean<span class="sc">-</span>choice.se, <span class="at">ymax=</span>choice.mean<span class="sc">+</span>choice.se, <span class="at">group=</span>Dataset, <span class="at">fill=</span>Dataset), <span class="at">alpha=</span>.<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb67-10"><a href="mem-aDDM.html#cb67-10" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;P(choose left)&quot;</span>) <span class="sc">+</span></span>
<span id="cb67-11"><a href="mem-aDDM.html#cb67-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Value difference (L-R)&quot;</span>) <span class="sc">+</span></span>
<span id="cb67-12"><a href="mem-aDDM.html#cb67-12" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb67-13"><a href="mem-aDDM.html#cb67-13" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb67-14"><a href="mem-aDDM.html#cb67-14" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb67-15"><a href="mem-aDDM.html#cb67-15" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="fu">c</span>(<span class="fl">0.25</span>,.<span class="dv">8</span>)</span>
<span id="cb67-16"><a href="mem-aDDM.html#cb67-16" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2
## 3.5.0.
## ℹ Please use the `legend.position.inside` argument of `theme()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="mem-aDDM.html#cb69-1" tabindex="-1"></a>mem.rt.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>pdata, <span class="fu">aes</span>(<span class="at">x=</span>vDiff)) <span class="sc">+</span></span>
<span id="cb69-2"><a href="mem-aDDM.html#cb69-2" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">&#39;grey&#39;</span>, <span class="at">alpha=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb69-3"><a href="mem-aDDM.html#cb69-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>rt.mean, <span class="at">group=</span>Dataset, <span class="at">color=</span>Dataset), <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb69-4"><a href="mem-aDDM.html#cb69-4" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>rt.mean<span class="sc">-</span>rt.se, <span class="at">ymax=</span>rt.mean<span class="sc">+</span>rt.se, <span class="at">group=</span>Dataset, <span class="at">fill=</span>Dataset), <span class="at">alpha=</span>.<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb69-5"><a href="mem-aDDM.html#cb69-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Response time (s)&quot;</span>) <span class="sc">+</span></span>
<span id="cb69-6"><a href="mem-aDDM.html#cb69-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Value difference (L-R)&quot;</span>) <span class="sc">+</span></span>
<span id="cb69-7"><a href="mem-aDDM.html#cb69-7" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb69-8"><a href="mem-aDDM.html#cb69-8" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb69-9"><a href="mem-aDDM.html#cb69-9" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">&quot;None&quot;</span></span>
<span id="cb69-10"><a href="mem-aDDM.html#cb69-10" tabindex="-1"></a>  )</span>
<span id="cb69-11"><a href="mem-aDDM.html#cb69-11" tabindex="-1"></a></span>
<span id="cb69-12"><a href="mem-aDDM.html#cb69-12" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb69-13"><a href="mem-aDDM.html#cb69-13" tabindex="-1"></a>  mem.choice.plot, mem.rt.plot,</span>
<span id="cb69-14"><a href="mem-aDDM.html#cb69-14" tabindex="-1"></a>  <span class="at">nrow=</span><span class="dv">1</span></span>
<span id="cb69-15"><a href="mem-aDDM.html#cb69-15" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="LateNightBayes_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
</div>
<div id="rt-with-low-and-high-exposure." class="section level3 hasAnchor" number="3.7.3">
<h3><span class="header-section-number">3.7.3</span> RT with low and high exposure.<a href="mem-aDDM.html#rt-with-low-and-high-exposure." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="mem-aDDM.html#cb70-1" tabindex="-1"></a><span class="co"># Get median pe for each subject and indicators for which obs are for low and high pe.</span></span>
<span id="cb70-2"><a href="mem-aDDM.html#cb70-2" tabindex="-1"></a></span>
<span id="cb70-3"><a href="mem-aDDM.html#cb70-3" tabindex="-1"></a>test <span class="ot">&lt;-</span> test <span class="sc">%&gt;%</span></span>
<span id="cb70-4"><a href="mem-aDDM.html#cb70-4" tabindex="-1"></a>  <span class="fu">group_by</span>(subject) <span class="sc">%&gt;%</span></span>
<span id="cb70-5"><a href="mem-aDDM.html#cb70-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb70-6"><a href="mem-aDDM.html#cb70-6" tabindex="-1"></a>    <span class="at">pe.med =</span> <span class="fu">median</span>(pe),</span>
<span id="cb70-7"><a href="mem-aDDM.html#cb70-7" tabindex="-1"></a>    <span class="at">pe.low =</span> pe <span class="sc">&lt;=</span> pe.med,</span>
<span id="cb70-8"><a href="mem-aDDM.html#cb70-8" tabindex="-1"></a>    <span class="at">pe.high =</span> pe <span class="sc">&gt;</span> pe.med,</span>
<span id="cb70-9"><a href="mem-aDDM.html#cb70-9" tabindex="-1"></a>    <span class="at">difficulty =</span> <span class="fu">abs</span>(vDiff)<span class="sc">*</span><span class="dv">10</span> <span class="co">#also a difficulty metric</span></span>
<span id="cb70-10"><a href="mem-aDDM.html#cb70-10" tabindex="-1"></a>  )</span>
<span id="cb70-11"><a href="mem-aDDM.html#cb70-11" tabindex="-1"></a></span>
<span id="cb70-12"><a href="mem-aDDM.html#cb70-12" tabindex="-1"></a>mem.sim <span class="ot">&lt;-</span> mem.sim <span class="sc">%&gt;%</span></span>
<span id="cb70-13"><a href="mem-aDDM.html#cb70-13" tabindex="-1"></a>  <span class="fu">group_by</span>(subj) <span class="sc">%&gt;%</span></span>
<span id="cb70-14"><a href="mem-aDDM.html#cb70-14" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb70-15"><a href="mem-aDDM.html#cb70-15" tabindex="-1"></a>    <span class="at">pe.med =</span> <span class="fu">median</span>(pe),</span>
<span id="cb70-16"><a href="mem-aDDM.html#cb70-16" tabindex="-1"></a>    <span class="at">pe.low =</span> pe <span class="sc">&lt;=</span> pe.med,</span>
<span id="cb70-17"><a href="mem-aDDM.html#cb70-17" tabindex="-1"></a>    <span class="at">pe.high =</span> pe <span class="sc">&gt;</span> pe.med,</span>
<span id="cb70-18"><a href="mem-aDDM.html#cb70-18" tabindex="-1"></a>    <span class="at">difficulty =</span> <span class="fu">abs</span>(vDiff) <span class="co">#also a difficulty metric</span></span>
<span id="cb70-19"><a href="mem-aDDM.html#cb70-19" tabindex="-1"></a>  )</span>
<span id="cb70-20"><a href="mem-aDDM.html#cb70-20" tabindex="-1"></a></span>
<span id="cb70-21"><a href="mem-aDDM.html#cb70-21" tabindex="-1"></a><span class="co"># real data</span></span>
<span id="cb70-22"><a href="mem-aDDM.html#cb70-22" tabindex="-1"></a></span>
<span id="cb70-23"><a href="mem-aDDM.html#cb70-23" tabindex="-1"></a>pdata.real.low <span class="ot">&lt;-</span> test[test<span class="sc">$</span>pe.low<span class="sc">==</span>T,] <span class="sc">%&gt;%</span></span>
<span id="cb70-24"><a href="mem-aDDM.html#cb70-24" tabindex="-1"></a>  <span class="fu">group_by</span>(subject, difficulty) <span class="sc">%&gt;%</span></span>
<span id="cb70-25"><a href="mem-aDDM.html#cb70-25" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb70-26"><a href="mem-aDDM.html#cb70-26" tabindex="-1"></a>    <span class="at">rt.mean =</span> <span class="fu">mean</span>(rt)</span>
<span id="cb70-27"><a href="mem-aDDM.html#cb70-27" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb70-28"><a href="mem-aDDM.html#cb70-28" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-29"><a href="mem-aDDM.html#cb70-29" tabindex="-1"></a>  <span class="fu">group_by</span>(difficulty) <span class="sc">%&gt;%</span></span>
<span id="cb70-30"><a href="mem-aDDM.html#cb70-30" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb70-31"><a href="mem-aDDM.html#cb70-31" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">mean</span>(rt.mean),</span>
<span id="cb70-32"><a href="mem-aDDM.html#cb70-32" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">std.error</span>(rt.mean),</span>
<span id="cb70-33"><a href="mem-aDDM.html#cb70-33" tabindex="-1"></a>    <span class="at">Dataset =</span> <span class="st">&quot;Real&quot;</span>,</span>
<span id="cb70-34"><a href="mem-aDDM.html#cb70-34" tabindex="-1"></a>    <span class="at">Exposure =</span> <span class="st">&quot;Low&quot;</span>,</span>
<span id="cb70-35"><a href="mem-aDDM.html#cb70-35" tabindex="-1"></a>    <span class="at">group =</span> <span class="dv">1</span></span>
<span id="cb70-36"><a href="mem-aDDM.html#cb70-36" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;subject&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="mem-aDDM.html#cb72-1" tabindex="-1"></a>pdata.real.high <span class="ot">&lt;-</span> test[test<span class="sc">$</span>pe.high<span class="sc">==</span>T,] <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="mem-aDDM.html#cb72-2" tabindex="-1"></a>  <span class="fu">group_by</span>(subject, difficulty) <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="mem-aDDM.html#cb72-3" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb72-4"><a href="mem-aDDM.html#cb72-4" tabindex="-1"></a>    <span class="at">rt.mean =</span> <span class="fu">mean</span>(rt)</span>
<span id="cb72-5"><a href="mem-aDDM.html#cb72-5" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb72-6"><a href="mem-aDDM.html#cb72-6" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-7"><a href="mem-aDDM.html#cb72-7" tabindex="-1"></a>  <span class="fu">group_by</span>(difficulty) <span class="sc">%&gt;%</span></span>
<span id="cb72-8"><a href="mem-aDDM.html#cb72-8" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb72-9"><a href="mem-aDDM.html#cb72-9" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">mean</span>(rt.mean),</span>
<span id="cb72-10"><a href="mem-aDDM.html#cb72-10" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">std.error</span>(rt.mean),</span>
<span id="cb72-11"><a href="mem-aDDM.html#cb72-11" tabindex="-1"></a>    <span class="at">Dataset =</span> <span class="st">&quot;Real&quot;</span>,</span>
<span id="cb72-12"><a href="mem-aDDM.html#cb72-12" tabindex="-1"></a>    <span class="at">Exposure =</span> <span class="st">&quot;High&quot;</span>,</span>
<span id="cb72-13"><a href="mem-aDDM.html#cb72-13" tabindex="-1"></a>    <span class="at">group =</span> <span class="dv">2</span></span>
<span id="cb72-14"><a href="mem-aDDM.html#cb72-14" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;subject&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="mem-aDDM.html#cb74-1" tabindex="-1"></a><span class="co"># simulated data</span></span>
<span id="cb74-2"><a href="mem-aDDM.html#cb74-2" tabindex="-1"></a></span>
<span id="cb74-3"><a href="mem-aDDM.html#cb74-3" tabindex="-1"></a>pdata.sim.low <span class="ot">&lt;-</span> mem.sim[mem.sim<span class="sc">$</span>pe.low<span class="sc">==</span>T,] <span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="mem-aDDM.html#cb74-4" tabindex="-1"></a>  <span class="fu">group_by</span>(subj, difficulty) <span class="sc">%&gt;%</span></span>
<span id="cb74-5"><a href="mem-aDDM.html#cb74-5" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb74-6"><a href="mem-aDDM.html#cb74-6" tabindex="-1"></a>    <span class="at">rt.mean =</span> <span class="fu">mean</span>(rt)</span>
<span id="cb74-7"><a href="mem-aDDM.html#cb74-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb74-8"><a href="mem-aDDM.html#cb74-8" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb74-9"><a href="mem-aDDM.html#cb74-9" tabindex="-1"></a>  <span class="fu">group_by</span>(difficulty) <span class="sc">%&gt;%</span></span>
<span id="cb74-10"><a href="mem-aDDM.html#cb74-10" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb74-11"><a href="mem-aDDM.html#cb74-11" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">mean</span>(rt.mean),</span>
<span id="cb74-12"><a href="mem-aDDM.html#cb74-12" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">std.error</span>(rt.mean),</span>
<span id="cb74-13"><a href="mem-aDDM.html#cb74-13" tabindex="-1"></a>    <span class="at">Dataset =</span> <span class="st">&quot;Simulated&quot;</span>,</span>
<span id="cb74-14"><a href="mem-aDDM.html#cb74-14" tabindex="-1"></a>    <span class="at">Exposure =</span> <span class="st">&quot;Low&quot;</span>,</span>
<span id="cb74-15"><a href="mem-aDDM.html#cb74-15" tabindex="-1"></a>    <span class="at">group =</span> <span class="dv">3</span></span>
<span id="cb74-16"><a href="mem-aDDM.html#cb74-16" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;subj&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="mem-aDDM.html#cb76-1" tabindex="-1"></a>pdata.sim.high <span class="ot">&lt;-</span> mem.sim[mem.sim<span class="sc">$</span>pe.high<span class="sc">==</span>T,] <span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="mem-aDDM.html#cb76-2" tabindex="-1"></a>  <span class="fu">group_by</span>(subj, difficulty) <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="mem-aDDM.html#cb76-3" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb76-4"><a href="mem-aDDM.html#cb76-4" tabindex="-1"></a>    <span class="at">rt.mean =</span> <span class="fu">mean</span>(rt)</span>
<span id="cb76-5"><a href="mem-aDDM.html#cb76-5" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb76-6"><a href="mem-aDDM.html#cb76-6" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb76-7"><a href="mem-aDDM.html#cb76-7" tabindex="-1"></a>  <span class="fu">group_by</span>(difficulty) <span class="sc">%&gt;%</span></span>
<span id="cb76-8"><a href="mem-aDDM.html#cb76-8" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb76-9"><a href="mem-aDDM.html#cb76-9" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">mean</span>(rt.mean),</span>
<span id="cb76-10"><a href="mem-aDDM.html#cb76-10" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">std.error</span>(rt.mean),</span>
<span id="cb76-11"><a href="mem-aDDM.html#cb76-11" tabindex="-1"></a>    <span class="at">Dataset =</span> <span class="st">&quot;Simulated&quot;</span>,</span>
<span id="cb76-12"><a href="mem-aDDM.html#cb76-12" tabindex="-1"></a>    <span class="at">Exposure =</span> <span class="st">&quot;High&quot;</span>,</span>
<span id="cb76-13"><a href="mem-aDDM.html#cb76-13" tabindex="-1"></a>    <span class="at">group =</span> <span class="dv">4</span></span>
<span id="cb76-14"><a href="mem-aDDM.html#cb76-14" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;subj&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="mem-aDDM.html#cb78-1" tabindex="-1"></a>pdata <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(pdata.real.low, pdata.real.high, pdata.sim.low, pdata.sim.high)</span>
<span id="cb78-2"><a href="mem-aDDM.html#cb78-2" tabindex="-1"></a></span>
<span id="cb78-3"><a href="mem-aDDM.html#cb78-3" tabindex="-1"></a>exposure.rt.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>pdata, <span class="fu">aes</span>(<span class="at">x=</span>difficulty)) <span class="sc">+</span></span>
<span id="cb78-4"><a href="mem-aDDM.html#cb78-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>y, <span class="at">group=</span>group, <span class="at">color=</span>Dataset, <span class="at">linetype=</span>Exposure), <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb78-5"><a href="mem-aDDM.html#cb78-5" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>y<span class="sc">-</span>se, <span class="at">ymax=</span>y<span class="sc">+</span>se, <span class="at">group=</span>group, <span class="at">fill=</span>Dataset), <span class="at">alpha=</span>.<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb78-6"><a href="mem-aDDM.html#cb78-6" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Response time (s)&quot;</span>) <span class="sc">+</span></span>
<span id="cb78-7"><a href="mem-aDDM.html#cb78-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Best - worst value&quot;</span>) <span class="sc">+</span></span>
<span id="cb78-8"><a href="mem-aDDM.html#cb78-8" tabindex="-1"></a>  <span class="fu">theme_classic</span>() </span>
<span id="cb78-9"><a href="mem-aDDM.html#cb78-9" tabindex="-1"></a></span>
<span id="cb78-10"><a href="mem-aDDM.html#cb78-10" tabindex="-1"></a>exposure.rt.plot</span></code></pre></div>
<p><img src="LateNightBayes_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-agranov2017" class="csl-entry">
Agranov, Marina, and Pietro Ortoleva. 2017. <span>“Stochastic Choice and Preferences for Randomization.”</span> <em>Journal of Political Economy</em> 125 (1): 40–68. <a href="https://doi.org/10.1086/689774">https://doi.org/10.1086/689774</a>.
</div>
<div id="ref-eum2022" class="csl-entry">
Eum, Brenden, Stephanie Dolbier, and Antonio Rangel. 2022. <span>“Peripheral Visual Information Halves Attentional Choice Bias.”</span> <a href="https://doi.org/10.1038/s41562-022-01318-6">https://doi.org/10.1038/s41562-022-01318-6</a>.
</div>
<div id="ref-kelly2013" class="csl-entry">
Kelly, S. P., and R. G. O’Connell. 2013. <span>“Internal and <span>External Influences</span> on the <span>Rate</span> of <span>Sensory Evidence Accumulation</span> in the <span>Human Brain</span>.”</span> <em>Journal of Neuroscience</em> 33 (50): 19434–41. <a href="https://doi.org/10.1523/JNEUROSCI.3355-13.2013">https://doi.org/10.1523/JNEUROSCI.3355-13.2013</a>.
</div>
<div id="ref-lombardi2021" class="csl-entry">
Lombardi, Gaia, and Todd Hare. 2021. <span>“Piecewise Constant Averaging Methods Allow for Fast and Accurate Hierarchical <span>Bayesian</span> Estimation of Drift Diffusion Models with Time-Varying Evidence Accumulation Rates.”</span> Preprint. <a href="https://doi.org/10.31234/osf.io/5azyx">https://doi.org/10.31234/osf.io/5azyx</a>.
</div>
<div id="ref-shadlen2016" class="csl-entry">
Shadlen, Michael N., and Daphna Shohamy. 2016. <span>“Decision <span>Making</span> and <span>Sequential Sampling</span> from <span>Memory</span>.”</span> <em>Neuron</em> 90 (5): 927–39. <a href="https://doi.org/10.1016/j.neuron.2016.04.036">https://doi.org/10.1016/j.neuron.2016.04.036</a>.
</div>
<div id="ref-smith2018" class="csl-entry">
Smith, Stephanie M., and Ian Krajbich. 2018. <span>“Attention and Choice Across Domains.”</span> <em>Journal of Experimental Psychology: General</em> 147 (12): 1810–26. <a href="https://doi.org/10.1037/xge0000482">https://doi.org/10.1037/xge0000482</a>.
</div>
<div id="ref-tavares2017" class="csl-entry">
Tavares, Gabriela, Pietro Perona, and Antonio Rangel. 2017. <span>“The <span>Attentional Drift Diffusion Model</span> of <span>Simple Perceptual Decision-Making</span>.”</span> <em>Frontiers in Neuroscience</em> 11: 468. <a href="https://doi.org/10.3389/fnins.2017.00468">https://doi.org/10.3389/fnins.2017.00468</a>.
</div>
<div id="ref-vanede2022" class="csl-entry">
van Ede, Freek, and Anna C. Nobre. 2022. <span>“A Neural Decision Signal During Internal Sampling from Working Memory.”</span> Preprint. <span>Neuroscience</span>. <a href="https://doi.org/10.1101/2022.03.31.486618">https://doi.org/10.1101/2022.03.31.486618</a>.
</div>
<div id="ref-weilbacher2021" class="csl-entry">
Weilbächer, Regina Agnes, Ian Krajbich, Jörg Rieskamp, and Sebastian Gluth. 2021. <span>“The Influence of Visual Attention on Memory-Based Preferential Choice.”</span> <em>Cognition</em> 215: 104804. <a href="https://doi.org/10.1016/j.cognition.2021.104804">https://doi.org/10.1016/j.cognition.2021.104804</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dcb.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="memDDM.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-mem-aDDM.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["LateNightBayes.pdf", "LateNightBayes.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
